let _v1_set_n4 _v6_trans _v9_path _v6_cur_value _v385_cont = let _v250_val = ( (* Eliminated vtable for field nil *) (QmlFlatServerLib.unsafe_get (0) (_v6_cur_value))) in
let _v249_val = let _v146_arg = let _v147_arg = ( (* Eliminated vtable for field edge_4_0 *) (QmlFlatServerLib.unsafe_get (3) (Link_web_chat_002._v1_edge_map_))) in
((OpabslgenMLRuntime.Badoplink.key_int) (_v147_arg)) in
(OpabslgenMLRuntime.Badoplink.dbpath_add (_v9_path) (_v146_arg)) in
(Link_web_chat_002._v1_set_n5 (_v6_trans) (_v249_val) (_v250_val) (_v385_cont))
let _v5_anon_fun_set_n6 _v2_extra_trans _v40_extra_cont _v148_arg = (OpabslgenMLRuntime.Badoplink.uppath (_v2_extra_trans) (_v148_arg) (_v40_extra_cont))
let _v0_clos_anon_fun_set_n6 = ((Obj.magic) ((Bsl_init_.bslp26 (_v5_anon_fun_set_n6) (3) (Link_web_chat_001._v115_const) (Link_web_chat_001._v2_const))))
let _v0_anon_fun_set_n6 _v5_extra_cur_value _v12_extra_path _v35_extra_cont _v16_tr = let _v256_val = ( (* Eliminated vtable for field hd *) (QmlFlatServerLib.unsafe_get (0) (_v5_extra_cur_value))) in
let _v255_val = let _v156_arg = let _v157_arg = ( (* Eliminated vtable for field edge_6_0 *) (QmlFlatServerLib.unsafe_get (4) (Link_web_chat_002._v1_edge_map_))) in
((OpabslgenMLRuntime.Badoplink.key_int) (_v157_arg)) in
(OpabslgenMLRuntime.Badoplink.dbpath_add (_v12_extra_path) (_v156_arg)) in
(Link_web_chat_002._v1_set_n7 (_v16_tr) (_v255_val) (_v256_val) (_v35_extra_cont))
let _v1_clos_anon_fun_set_n6 = ((Obj.magic) ((Bsl_init_.bslp26 (_v0_anon_fun_set_n6) (4) (Link_web_chat_001._v116_const) (Link_web_chat_001._v2_const))))
let _v3_anon_fun_set_n6 _v13_extra_path _v36_extra_cont _v16_extra_val _v0_trans1 = let _v253_val = let _v152_arg = let _v153_arg = ( (* Eliminated vtable for field edge_6_1 *) (QmlFlatServerLib.unsafe_get (5) (Link_web_chat_002._v1_edge_map_))) in
((OpabslgenMLRuntime.Badoplink.key_int) (_v153_arg)) in
(OpabslgenMLRuntime.Badoplink.dbpath_add (_v13_extra_path) (_v152_arg)) in
(OpabslgenMLRuntime.Badoplink.set_link (_v0_trans1) (_v253_val) (_v16_extra_val) (_v36_extra_cont))
let _v2_clos_anon_fun_set_n6 = ((Obj.magic) ((Bsl_init_.bslp26 (_v3_anon_fun_set_n6) (4) (Link_web_chat_001._v117_const) (Link_web_chat_001._v2_const))))
let _v4_anon_fun_set_n6 _v38_extra_cont _v149_arg = let _v251_val = ((OpabslgenMLRuntime.Badoplink.key_int) (_v149_arg)) in
(QmlCpsServerLib.return (_v38_extra_cont) (_v251_val))
let _v3_clos_anon_fun_set_n6 = ((Obj.magic) ((Bsl_init_.bslp26 (_v4_anon_fun_set_n6) (2) (Link_web_chat_001._v118_const) (Link_web_chat_001._v2_const))))
let _v2_anon_fun_set_n3 _v10_extra_path _v0_extra_nil _v33_extra_cont _v1_tr2 = let _v265_val = ((QmlFlatServerLib.may_be_simple) ([| (((Obj.repr) (( (* ["nil"] *) Link_web_chat_001._v2_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v0_extra_nil))) |])) in
let _v264_val = let _v168_arg = let _v169_arg = ( (* Eliminated vtable for field edge_3_1 *) (QmlFlatServerLib.unsafe_get (2) (Link_web_chat_002._v1_edge_map_))) in
((OpabslgenMLRuntime.Badoplink.key_int) (_v169_arg)) in
(OpabslgenMLRuntime.Badoplink.dbpath_add (_v10_extra_path) (_v168_arg)) in
(_v1_set_n4 (_v1_tr2) (_v264_val) (_v265_val) (_v33_extra_cont))
let _v0_clos_anon_fun_set_n3 = ((Obj.magic) ((Bsl_init_.bslp26 (_v2_anon_fun_set_n3) (4) (Link_web_chat_001._v119_const) (Link_web_chat_001._v2_const))))
let _v1_clos_anon_fun_set_n3 = ((Obj.magic) ((Bsl_init_.bslp27 (4) (Link_web_chat_001._v120_const) (Link_web_chat_001._v2_const))))
and _v2_clos_anon_fun_set_n3 = ((Obj.magic) ((Bsl_init_.bslp27 (5) (Link_web_chat_001._v121_const) (Link_web_chat_001._v2_const))))
and _v4_clos_anon_fun_set_n6 = ((Obj.magic) ((Bsl_init_.bslp27 (5) (Link_web_chat_001._v122_const) (Link_web_chat_001._v2_const))))
and _v5_clos_anon_fun_set_n6 = ((Obj.magic) ((Bsl_init_.bslp27 (6) (Link_web_chat_001._v123_const) (Link_web_chat_001._v2_const))))
let rec _v0_anon_fun_set_n3 _v4_extra_cur_value _v11_extra_path _v34_extra_cont _v1_tr1 = (match ((QmlFlatServerLib.unwrap_record) (_v4_extra_cur_value)) with
[| _v12_vt ; _ ; lazy _v2_hd ; lazy _v11_tl |] when (((==)) (((Obj.magic) (_v12_vt))) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable))) -> let _v1_hd = ((Obj.magic) (_v2_hd)) in
let _v1_tl = ((Obj.magic) (_v11_tl)) in
let _v414_cont = (QmlCpsServerLib.ccont (_v34_extra_cont) ((Bsl_init_.clos_env_4 (_v2_clos_anon_fun_set_n3) (_v11_extra_path) (_v1_tl) (_v1_hd) (_v34_extra_cont)))) in
let _v257_val = let _v159_arg = ( (* Eliminated vtable for field edge_3_0 *) (QmlFlatServerLib.unsafe_get (1) (Link_web_chat_002._v1_edge_map_))) in
((OpabslgenMLRuntime.Badoplink.Data.int) (_v159_arg)) in
(OpabslgenMLRuntime.Badoplink.set (_v1_tr1) (_v11_extra_path) (_v257_val) (_v414_cont))
| [| _v13_vt ; _ ; lazy _v22_nil |] when (((==)) (((Obj.magic) (_v13_vt))) (( (* ["nil"] *) Link_web_chat_001._v2_shared_vtable))) -> let _v1_nil = ((Obj.magic) (_v22_nil)) in
let _v425_cont = (QmlCpsServerLib.ccont (_v34_extra_cont) ((Bsl_init_.clos_env_3 (_v0_clos_anon_fun_set_n3) (_v11_extra_path) (_v1_nil) (_v34_extra_cont)))) in
let _v262_val = let _v165_arg = ( (* Eliminated vtable for field edge_3_1 *) (QmlFlatServerLib.unsafe_get (2) (Link_web_chat_002._v1_edge_map_))) in
((OpabslgenMLRuntime.Badoplink.Data.int) (_v165_arg)) in
(OpabslgenMLRuntime.Badoplink.set (_v1_tr1) (_v11_extra_path) (_v262_val) (_v425_cont)))
and _v1_anon_fun_set_n3 _v9_extra_path _v0_extra_tl _v0_extra_hd _v32_extra_cont _v0_tr2 = let _v261_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v0_extra_hd))) ; (((Obj.repr) (_v0_extra_tl))) |])) in
let _v260_val = let _v162_arg = let _v163_arg = ( (* Eliminated vtable for field edge_3_0 *) (QmlFlatServerLib.unsafe_get (1) (Link_web_chat_002._v1_edge_map_))) in
((OpabslgenMLRuntime.Badoplink.key_int) (_v163_arg)) in
(OpabslgenMLRuntime.Badoplink.dbpath_add (_v9_extra_path) (_v162_arg)) in
(_v1_set_n6 (_v0_tr2) (_v260_val) (_v261_val) (_v32_extra_cont))
and _v1_set_n6 _v8_trans _v11_path _v8_cur_value _v392_cont = let _v393_cont = (QmlCpsServerLib.ccont (_v392_cont) ((Bsl_init_.clos_env_3 (_v1_clos_anon_fun_set_n6) (_v8_cur_value) (_v11_path) (_v392_cont)))) in
let _v394_cont = (QmlCpsServerLib.ccont (_v393_cont) ((Bsl_init_.clos_env_4 (_v4_clos_anon_fun_set_n6) (_v8_cur_value) (_v8_trans) (_v11_path) (_v393_cont)))) in
let _v395_cont = (QmlCpsServerLib.ccont (_v394_cont) ((Bsl_init_.clos_env_2 (_v0_clos_anon_fun_set_n6) (_v8_trans) (_v394_cont)))) in
(OpabslgenMLRuntime.Badoplink.uppath (_v8_trans) (_v11_path) (_v395_cont))
and _v1_anon_fun_set_n6 _v7_extra_cur_value _v1_extra_trans _v15_extra_path _v39_extra_cont _v0_dbpath_dest = let _v396_cont = (QmlCpsServerLib.ccont (_v39_extra_cont) ((Bsl_init_.clos_env_5 (_v5_clos_anon_fun_set_n6) (_v7_extra_cur_value) (_v1_extra_trans) (_v15_extra_path) (_v0_dbpath_dest) (_v39_extra_cont)))) in
let _v397_cont = (QmlCpsServerLib.ccont (_v396_cont) ((Bsl_init_.clos_env_1 (_v3_clos_anon_fun_set_n6) (_v396_cont)))) in
(OpabslgenMLRuntime.Badoplink.get_new_key (_v1_extra_trans) (_v0_dbpath_dest) (_v397_cont))
and _v2_anon_fun_set_n6 _v6_extra_cur_value _v0_extra_trans _v14_extra_path _v0_extra_dbpath_dest _v37_extra_cont _v0_newkey = let _v254_val = (OpabslgenMLRuntime.Badoplink.dbpath_add (_v0_extra_dbpath_dest) (_v0_newkey)) in
let _v399_cont = (QmlCpsServerLib.ccont (_v37_extra_cont) ((Bsl_init_.clos_env_3 (_v2_clos_anon_fun_set_n6) (_v14_extra_path) (_v37_extra_cont) (_v254_val)))) in
let _v252_val = ( (* Eliminated vtable for field tl *) (QmlFlatServerLib.unsafe_get (1) (_v6_extra_cur_value))) in
(_v1_set_n3 (_v0_extra_trans) (_v254_val) (_v252_val) (_v399_cont))
and _v1_set_n3 _v5_trans _v8_path _v5_cur_value _v412_cont = let _v413_cont = (QmlCpsServerLib.ccont (_v412_cont) ((Bsl_init_.clos_env_3 (_v1_clos_anon_fun_set_n3) (_v5_cur_value) (_v8_path) (_v412_cont)))) in
(OpabslgenMLRuntime.Badoplink.remove_children (_v5_trans) (_v8_path) (_v413_cont))
let _v8__ = ((Obj.magic) ((Bsl_init_.bslp28 (_v1_clos_anon_fun_set_n3) (_v0_anon_fun_set_n3))))
and _v9__ = ((Obj.magic) ((Bsl_init_.bslp28 (_v2_clos_anon_fun_set_n3) (_v1_anon_fun_set_n3))))
and _v11__ = ((Obj.magic) ((Bsl_init_.bslp28 (_v4_clos_anon_fun_set_n6) (_v1_anon_fun_set_n6))))
and _v12__ = ((Obj.magic) ((Bsl_init_.bslp28 (_v5_clos_anon_fun_set_n6) (_v2_anon_fun_set_n6))))
let _v0_anon_fun_set_n2 _v8_extra_cur_value _v16_extra_path _v41_extra_cont _v0_tr1 = let _v267_val = let _v171_arg = let _v172_arg = 0 in
((OpabslgenMLRuntime.Badoplink.key_int) (_v172_arg)) in
(OpabslgenMLRuntime.Badoplink.dbpath_add (_v16_extra_path) (_v171_arg)) in
(_v1_set_n3 (_v0_tr1) (_v267_val) (_v8_extra_cur_value) (_v41_extra_cont))
let _v0_clos_anon_fun_set_n2 = ((Obj.magic) ((Bsl_init_.bslp26 (_v0_anon_fun_set_n2) (4) (Link_web_chat_001._v124_const) (Link_web_chat_001._v2_const))))
let _v1_set_n2 _v4_trans _v7_path _v4_cur_value _v436_cont = let _v437_cont = (QmlCpsServerLib.ccont (_v436_cont) ((Bsl_init_.clos_env_3 (_v0_clos_anon_fun_set_n2) (_v4_cur_value) (_v7_path) (_v436_cont)))) in
(OpabslgenMLRuntime.Badoplink.remove_children (_v4_trans) (_v7_path) (_v437_cont))
let _v1_anon_fun_set_n1 _v0_extra_path _v0_k _v2_x _v0_trans_acc _v441_cont = let _v268_val = let _v174_arg = ((OpabslgenMLRuntime.Badoplink.key_string) (_v0_k)) in
(OpabslgenMLRuntime.Badoplink.dbpath_add (_v0_extra_path) (_v174_arg)) in
(_v1_set_n2 (_v0_trans_acc) (_v268_val) (_v2_x) (_v441_cont))
let _v0_clos_anon_fun_set_n1 = ((Obj.magic) ((Bsl_init_.bslp26 (_v1_anon_fun_set_n1) (5) (Link_web_chat_001._v125_const) (Link_web_chat_001._v2_const))))
let _v3_anon_fun_set_n1 _v9_extra_cur_value _v17_extra_path _v42_extra_cont _v0_loc_trans1 = let _v270_val = (Bsl_init_.clos_env_1 (_v0_clos_anon_fun_set_n1) (_v17_extra_path)) in
(Bsl_init_.clos_args_4 (Opa_stdlib_2ecore_2emap_007._v1_StringMap_fold_ec0784c7) (_v270_val) (_v9_extra_cur_value) (_v0_loc_trans1) (_v42_extra_cont))
let _v1_clos_anon_fun_set_n1 = ((Obj.magic) ((Bsl_init_.bslp26 (_v3_anon_fun_set_n1) (4) (Link_web_chat_001._v126_const) (Link_web_chat_001._v2_const))))
let _v2_anon_fun_set_n1 _v10_extra_cur_value _v18_extra_path _v43_extra_cont _v0_loc_trans2 = let _v446_cont = (QmlCpsServerLib.ccont (_v43_extra_cont) ((Bsl_init_.clos_env_3 (_v1_clos_anon_fun_set_n1) (_v10_extra_cur_value) (_v18_extra_path) (_v43_extra_cont)))) in
let _v269_val = ((OpabslgenMLRuntime.Badoplink.Data.unit) (())) in
(OpabslgenMLRuntime.Badoplink.set (_v0_loc_trans2) (_v18_extra_path) (_v269_val) (_v446_cont))
let _v2_clos_anon_fun_set_n1 = ((Obj.magic) ((Bsl_init_.bslp26 (_v2_anon_fun_set_n1) (4) (Link_web_chat_001._v127_const) (Link_web_chat_001._v2_const))))
let _v1_set_n1 _v0_trans _v3_path _v0_cur_value _v444_cont = let _v445_cont = (QmlCpsServerLib.ccont (_v444_cont) ((Bsl_init_.clos_env_3 (_v2_clos_anon_fun_set_n1) (_v0_cur_value) (_v3_path) (_v444_cont)))) in
(OpabslgenMLRuntime.Badoplink.clear (_v0_trans) (_v3_path) (_v445_cont))
let _v0_anon_fun_room _v0_extra_room_barrier _v271_val = (QmlCpsServerLib.black_release_barrier (_v0_extra_room_barrier) (_v271_val))
let _v0_clos_anon_fun_room = ((Obj.magic) ((Bsl_init_.bslp26 (_v0_anon_fun_room) (2) (Link_web_chat_001._v128_const) (Link_web_chat_001._v2_const))))
let _v2_room = ((Obj.magic) (let _v4_before = ((QmlCpsServerLib.before_wait) (Link_web_chat_001._v1_const)) in
let _v0_room_barrier = ((QmlCpsServerLib.black_make_barrier) (Link_web_chat_001._v129_const)) in
let _v4_barrier_unit = let _v272_val = Link_web_chat_001._v130_const in
let _v450_cont = ((QmlCpsServerLib.cont) ((Bsl_init_.clos_env_1 (_v0_clos_anon_fun_room) (_v0_room_barrier)))) in
(Opa_stdlib_2ecore_2erpc_2ecore_018._v2_cloud_f2f00d5f (Link_web_chat_002._v1_memo_ty) (_v272_val) (_v450_cont)) in
((OpabslgenMLRuntime.BslCps.black_toplevel_wait) (_v0_room_barrier))))
let _v4_anon_fun_stamp _v47_extra_cont _v278_val = let _v283_val = Link_web_chat_001._v13_const in
let _v282_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v278_val))) ; (((Obj.repr) (_v283_val))) |])) in
(QmlCpsServerLib.return (_v47_extra_cont) (_v282_val))
let _v0_clos_anon_fun_stamp = ((Obj.magic) ((Bsl_init_.bslp26 (_v4_anon_fun_stamp) (2) (Link_web_chat_001._v131_const) (Link_web_chat_001._v2_const))))
let _v5_anon_fun_stamp _v48_extra_cont _v181_arg = let _v279_val = ((Opa_stdlib_2ecore_014._v0_of_int_skip_ec6de8cf) (_v181_arg)) in
(QmlCpsServerLib.return (_v48_extra_cont) (_v279_val))
let _v1_clos_anon_fun_stamp = ((Obj.magic) ((Bsl_init_.bslp26 (_v5_anon_fun_stamp) (2) (Link_web_chat_001._v132_const) (Link_web_chat_001._v2_const))))
let _v0_anon_fun_stamp _v44_extra_cont _v178_arg = (Opa_stdlib_2ecore_013._v1_sc_list_ec6de8cf (_v178_arg) (_v44_extra_cont))
let _v2_clos_anon_fun_stamp = ((Obj.magic) ((Bsl_init_.bslp26 (_v0_anon_fun_stamp) (2) (Link_web_chat_001._v133_const) (Link_web_chat_001._v2_const))))
let _v2_anon_fun_stamp _v45_extra_cont _v17_extra_val _v275_val = let _v286_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v17_extra_val))) ; (((Obj.repr) (_v275_val))) |])) in
(QmlCpsServerLib.return (_v45_extra_cont) (_v286_val))
let _v3_clos_anon_fun_stamp = ((Obj.magic) ((Bsl_init_.bslp26 (_v2_anon_fun_stamp) (3) (Link_web_chat_001._v134_const) (Link_web_chat_001._v2_const))))
let _v3_anon_fun_stamp _v46_extra_cont _v18_extra_val _v277_val = let _v284_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v18_extra_val))) ; (((Obj.repr) (_v277_val))) |])) in
(QmlCpsServerLib.return (_v46_extra_cont) (_v284_val))
let _v4_clos_anon_fun_stamp = ((Obj.magic) ((Bsl_init_.bslp26 (_v3_anon_fun_stamp) (3) (Link_web_chat_001._v135_const) (Link_web_chat_001._v2_const))))
let _v6_anon_fun_stamp _v49_extra_cont _v182_arg = (Bsl_init_.clos_args_2 (Opa_stdlib_2ecore_2edate_010._v1_get_min_7e5812a5) (_v182_arg) (_v49_extra_cont))
let _v5_clos_anon_fun_stamp = ((Obj.magic) ((Bsl_init_.bslp26 (_v6_anon_fun_stamp) (2) (Link_web_chat_001._v136_const) (Link_web_chat_001._v2_const))))
let _v1_anon_fun_stamp _v50_extra_cont _v273_val = let _v456_cont = (QmlCpsServerLib.ccont (_v50_extra_cont) ((Bsl_init_.clos_env_2 (_v3_clos_anon_fun_stamp) (_v50_extra_cont) (_v273_val)))) in
let _v285_val = Link_web_chat_001._v137_const in
let _v458_cont = (QmlCpsServerLib.ccont (_v456_cont) ((Bsl_init_.clos_env_2 (_v4_clos_anon_fun_stamp) (_v456_cont) (_v285_val)))) in
let _v459_cont = (QmlCpsServerLib.ccont (_v458_cont) ((Bsl_init_.clos_env_1 (_v0_clos_anon_fun_stamp) (_v458_cont)))) in
let _v460_cont = (QmlCpsServerLib.ccont (_v459_cont) ((Bsl_init_.clos_env_1 (_v1_clos_anon_fun_stamp) (_v459_cont)))) in
let _v461_cont = (QmlCpsServerLib.ccont (_v460_cont) ((Bsl_init_.clos_env_1 (_v5_clos_anon_fun_stamp) (_v460_cont)))) in
((Opa_stdlib_2ecore_2edate_008._v1_now_7e5812a5) (_v461_cont))
let _v6_clos_anon_fun_stamp = ((Obj.magic) ((Bsl_init_.bslp26 (_v1_anon_fun_stamp) (2) (Link_web_chat_001._v138_const) (Link_web_chat_001._v2_const))))
let _v7_anon_fun_stamp _v51_extra_cont _v179_arg = let _v274_val = ((Opa_stdlib_2ecore_014._v0_of_int_skip_ec6de8cf) (_v179_arg)) in
(QmlCpsServerLib.return (_v51_extra_cont) (_v274_val))
let _v7_clos_anon_fun_stamp = ((Obj.magic) ((Bsl_init_.bslp26 (_v7_anon_fun_stamp) (2) (Link_web_chat_001._v139_const) (Link_web_chat_001._v2_const))))
let _v8_anon_fun_stamp _v52_extra_cont _v180_arg = (Bsl_init_.clos_args_2 (Opa_stdlib_2ecore_2edate_010._v1_get_hour_7e5812a5) (_v180_arg) (_v52_extra_cont))
let _v8_clos_anon_fun_stamp = ((Obj.magic) ((Bsl_init_.bslp26 (_v8_anon_fun_stamp) (2) (Link_web_chat_001._v140_const) (Link_web_chat_001._v2_const))))
let _v1_stamp _v451_cont = let _v452_cont = (QmlCpsServerLib.ccont (_v451_cont) ((Bsl_init_.clos_env_1 (_v2_clos_anon_fun_stamp) (_v451_cont)))) in
let _v453_cont = (QmlCpsServerLib.ccont (_v452_cont) ((Bsl_init_.clos_env_1 (_v6_clos_anon_fun_stamp) (_v452_cont)))) in
let _v454_cont = (QmlCpsServerLib.ccont (_v453_cont) ((Bsl_init_.clos_env_1 (_v7_clos_anon_fun_stamp) (_v453_cont)))) in
let _v455_cont = (QmlCpsServerLib.ccont (_v454_cont) ((Bsl_init_.clos_env_1 (_v8_clos_anon_fun_stamp) (_v454_cont)))) in
((Opa_stdlib_2ecore_2edate_008._v1_now_7e5812a5) (_v455_cont))
let _v0_clos_stamp = ((Obj.magic) ((Bsl_init_.bslp26 (_v1_stamp) (1) (Link_web_chat_001._v141_const) (Link_web_chat_001._v142_const))))
let _v2_anon_fun_save_message _v1_extra_path _v31_tr _v464_cont = (Link_web_chat_002._v1_get_n3 (_v31_tr) (_v1_extra_path) (_v464_cont))
let _v0_clos_anon_fun_save_message = ((Obj.magic) ((Bsl_init_.bslp26 (_v2_anon_fun_save_message) (3) (Link_web_chat_001._v143_const) (Link_web_chat_001._v2_const))))
let _v0_anon_fun_anon_fun_save_message _v0_extra_x _v0_extra_extra_path _v53_extra_cont _v32_tr = (_v1_set_n3 (_v32_tr) (_v0_extra_extra_path) (_v0_extra_x) (_v53_extra_cont))
let _v0_clos_anon_fun_anon_fun_save_message = ((Obj.magic) ((Bsl_init_.bslp26 (_v0_anon_fun_anon_fun_save_message) (4) (Link_web_chat_001._v144_const) (Link_web_chat_001._v2_const))))
let _v1_anon_fun_anon_fun_save_message _v10_extra_tr _v54_extra_cont _v183_arg = (OpabslgenMLRuntime.Badoplink.clear (_v10_extra_tr) (_v183_arg) (_v54_extra_cont))
let _v1_clos_anon_fun_anon_fun_save_message = ((Obj.magic) ((Bsl_init_.bslp26 (_v1_anon_fun_anon_fun_save_message) (3) (Link_web_chat_001._v145_const) (Link_web_chat_001._v2_const))))
let _v2_anon_fun_anon_fun_save_message _v55_extra_cont _v19_extra_val _v184_arg = let _v292_val = (OpabslgenMLRuntime.Badoplink.dbpath_add (_v184_arg) (_v19_extra_val)) in
(QmlCpsServerLib.return (_v55_extra_cont) (_v292_val))
let _v2_clos_anon_fun_anon_fun_save_message = ((Obj.magic) ((Bsl_init_.bslp26 (_v2_anon_fun_anon_fun_save_message) (3) (Link_web_chat_001._v146_const) (Link_web_chat_001._v2_const))))
let _v3_anon_fun_anon_fun_save_message _v56_extra_cont _v20_extra_val _v186_arg = let _v290_val = (OpabslgenMLRuntime.Badoplink.dbpath_add (_v186_arg) (_v20_extra_val)) in
(QmlCpsServerLib.return (_v56_extra_cont) (_v290_val))
let _v3_clos_anon_fun_anon_fun_save_message = ((Obj.magic) ((Bsl_init_.bslp26 (_v3_anon_fun_anon_fun_save_message) (3) (Link_web_chat_001._v147_const) (Link_web_chat_001._v2_const))))
let _v3_anon_fun_save_message _v0_extra_room _v2_extra_path _v30_tr _v11_x _v465_cont = let _v466_cont = (QmlCpsServerLib.ccont (_v465_cont) ((Bsl_init_.clos_env_3 (_v0_clos_anon_fun_anon_fun_save_message) (_v11_x) (_v2_extra_path) (_v465_cont)))) in
let _v467_cont = (QmlCpsServerLib.ccont (_v466_cont) ((Bsl_init_.clos_env_2 (_v1_clos_anon_fun_anon_fun_save_message) (_v30_tr) (_v466_cont)))) in
let _v293_val = ((OpabslgenMLRuntime.Badoplink.key_string) (_v0_extra_room)) in
let _v469_cont = (QmlCpsServerLib.ccont (_v467_cont) ((Bsl_init_.clos_env_2 (_v2_clos_anon_fun_anon_fun_save_message) (_v467_cont) (_v293_val)))) in
let _v291_val = let _v188_arg = ( (* Eliminated vtable for field edge_root_0 *) (QmlFlatServerLib.unsafe_get (13) (Link_web_chat_002._v1_edge_map_))) in
((OpabslgenMLRuntime.Badoplink.key_int) (_v188_arg)) in
let _v473_cont = (QmlCpsServerLib.ccont (_v469_cont) ((Bsl_init_.clos_env_2 (_v3_clos_anon_fun_anon_fun_save_message) (_v469_cont) (_v291_val)))) in
let _v289_val = let _v191_arg = 1 in
((OpabslgenMLRuntime.Badoplink.key_int) (_v191_arg)) in
let _v287_val = OpabslgenMLRuntime.Badoplink.dbpath_root in
let _v288_val = (OpabslgenMLRuntime.Badoplink.dbpath_add (_v287_val) (_v289_val)) in
(QmlCpsServerLib.return (_v473_cont) (_v288_val))
let _v1_clos_anon_fun_save_message = ((Obj.magic) ((Bsl_init_.bslp26 (_v3_anon_fun_save_message) (5) (Link_web_chat_001._v148_const) (Link_web_chat_001._v2_const))))
let _v5_anon_fun_save_message _v57_extra_cont _v0_extra_arg _v192_arg = (Opa_stdlib_2ecore_2edb_002._v2_bec4a73d_c1ad0b27 (_v192_arg) (_v0_extra_arg) (_v57_extra_cont))
let _v2_clos_anon_fun_save_message = ((Obj.magic) ((Bsl_init_.bslp26 (_v5_anon_fun_save_message) (3) (Link_web_chat_001._v149_const) (Link_web_chat_001._v2_const))))
let _v15_anon_fun_save_message _v67_extra_cont _v26_extra_val _v197_arg = let _v302_val = (OpabslgenMLRuntime.Badoplink.dbpath_add (_v197_arg) (_v26_extra_val)) in
(QmlCpsServerLib.return (_v67_extra_cont) (_v302_val))
let _v3_clos_anon_fun_save_message = ((Obj.magic) ((Bsl_init_.bslp26 (_v15_anon_fun_save_message) (3) (Link_web_chat_001._v150_const) (Link_web_chat_001._v2_const))))
let _v6_anon_fun_save_message _v1_extra_room _v58_extra_cont _v15_path = let _v324_val = (Bsl_init_.clos_env_2 (_v1_clos_anon_fun_save_message) (_v1_extra_room) (_v15_path)) in
let _v323_val = (Bsl_init_.clos_env_1 (_v0_clos_anon_fun_save_message) (_v15_path)) in
(Bsl_init_.bslp37 (Link_web_chat_002._v1__inaccessible_db_ident) (_v15_path) (_v323_val) (_v324_val) (_v58_extra_cont))
let _v4_clos_anon_fun_save_message = ((Obj.magic) ((Bsl_init_.bslp26 (_v6_anon_fun_save_message) (3) (Link_web_chat_001._v151_const) (Link_web_chat_001._v2_const))))
let _v16_anon_fun_save_message _v68_extra_cont _v27_extra_val _v200_arg = let _v300_val = (OpabslgenMLRuntime.Badoplink.dbpath_add (_v200_arg) (_v27_extra_val)) in
(QmlCpsServerLib.return (_v68_extra_cont) (_v300_val))
let _v5_clos_anon_fun_save_message = ((Obj.magic) ((Bsl_init_.bslp26 (_v16_anon_fun_save_message) (3) (Link_web_chat_001._v152_const) (Link_web_chat_001._v2_const))))
let _v7_anon_fun_save_message _v59_extra_cont _v21_extra_val _v208_arg = let _v321_val = (OpabslgenMLRuntime.Badoplink.dbpath_add (_v208_arg) (_v21_extra_val)) in
(QmlCpsServerLib.return (_v59_extra_cont) (_v321_val))
let _v6_clos_anon_fun_save_message = ((Obj.magic) ((Bsl_init_.bslp26 (_v7_anon_fun_save_message) (3) (Link_web_chat_001._v153_const) (Link_web_chat_001._v2_const))))
let _v17_anon_fun_save_message _v69_extra_cont _v28_extra_val _v202_arg = let _v298_val = (OpabslgenMLRuntime.Badoplink.dbpath_add (_v202_arg) (_v28_extra_val)) in
(QmlCpsServerLib.return (_v69_extra_cont) (_v298_val))
let _v7_clos_anon_fun_save_message = ((Obj.magic) ((Bsl_init_.bslp26 (_v17_anon_fun_save_message) (3) (Link_web_chat_001._v154_const) (Link_web_chat_001._v2_const))))
let _v8_anon_fun_save_message _v60_extra_cont _v22_extra_val _v211_arg = let _v319_val = (OpabslgenMLRuntime.Badoplink.dbpath_add (_v211_arg) (_v22_extra_val)) in
(QmlCpsServerLib.return (_v60_extra_cont) (_v319_val))
let _v8_clos_anon_fun_save_message = ((Obj.magic) ((Bsl_init_.bslp26 (_v8_anon_fun_save_message) (3) (Link_web_chat_001._v155_const) (Link_web_chat_001._v2_const))))
let _v18_anon_fun_save_message _v71_extra_cont _v294_val = (match ((QmlFlatServerLib.unwrap_record) (_v294_val)) with
[| _v14_vt ; _ ; lazy _v16_some |] when (((==)) (((Obj.magic) (_v14_vt))) (( (* ["some"] *) Link_web_chat_001._v18_shared_vtable))) -> let _v12_x = ((Obj.magic) (_v16_some)) in
(QmlCpsServerLib.return (_v71_extra_cont) (_v12_x))
| _v10_none when (((==)) (((Obj.magic) (_v10_none))) (Link_web_chat_001._v0_simple_none)) -> (OpabslgenMLRuntime.Badoplink.trans_start (Link_web_chat_002._v1__inaccessible_db_ident) (_v71_extra_cont)))
let _v9_clos_anon_fun_save_message = ((Obj.magic) ((Bsl_init_.bslp26 (_v18_anon_fun_save_message) (2) (Link_web_chat_001._v156_const) (Link_web_chat_001._v2_const))))
let _v9_anon_fun_save_message _v61_extra_cont _v23_extra_val _v213_arg = let _v317_val = (OpabslgenMLRuntime.Badoplink.dbpath_add (_v213_arg) (_v23_extra_val)) in
(QmlCpsServerLib.return (_v61_extra_cont) (_v317_val))
let _v10_clos_anon_fun_save_message = ((Obj.magic) ((Bsl_init_.bslp26 (_v9_anon_fun_save_message) (3) (Link_web_chat_001._v157_const) (Link_web_chat_001._v2_const))))
let _v11_anon_fun_save_message _v63_extra_cont _v1_extra_arg _v194_arg = let _v313_val = (Opa_stdlib_2ecore_014._v0_cons_skip_ec6de8cf (_v194_arg) (_v1_extra_arg)) in
(QmlCpsServerLib.return (_v63_extra_cont) (_v313_val))
let _v11_clos_anon_fun_save_message = ((Obj.magic) ((Bsl_init_.bslp26 (_v11_anon_fun_save_message) (3) (Link_web_chat_001._v158_const) (Link_web_chat_001._v2_const))))
let _v12_anon_fun_save_message _v64_extra_cont _v24_extra_val _v25_extra_val _v306_val = let _v310_val = Link_web_chat_001._v2_const in
let _v309_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["author" ; "text" ; "time" ; "welcome"] *) Link_web_chat_001._v24_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v25_extra_val))) ; (((Obj.repr) (_v24_extra_val))) ; (((Obj.repr) (_v306_val))) ; (((Obj.repr) (_v310_val))) |])) in
(QmlCpsServerLib.return (_v64_extra_cont) (_v309_val))
let _v12_clos_anon_fun_save_message = ((Obj.magic) ((Bsl_init_.bslp26 (_v12_anon_fun_save_message) (4) (Link_web_chat_001._v159_const) (Link_web_chat_001._v2_const))))
let _v10_anon_fun_save_message _v0_extra_message _v65_extra_cont _v195_arg = let _v495_cont = (QmlCpsServerLib.ccont (_v65_extra_cont) ((Bsl_init_.clos_env_2 (_v11_clos_anon_fun_save_message) (_v65_extra_cont) (_v195_arg)))) in
let _v312_val = ( (* Cache case *) (QmlFlatServerLib.dot_with_cache (Link_web_chat_001._v0_access_cache) (Link_web_chat_001._v0_label_author) (_v0_extra_message))) in
let _v311_val = ( (* Cache case *) (QmlFlatServerLib.dot_with_cache (Link_web_chat_001._v1_access_cache) (Link_web_chat_001._v0_label_text) (_v0_extra_message))) in
let _v500_cont = (QmlCpsServerLib.ccont (_v495_cont) ((Bsl_init_.clos_env_3 (_v12_clos_anon_fun_save_message) (_v495_cont) (_v311_val) (_v312_val)))) in
((_v1_stamp) (_v500_cont))
let _v13_clos_anon_fun_save_message = ((Obj.magic) ((Bsl_init_.bslp26 (_v10_anon_fun_save_message) (3) (Link_web_chat_001._v160_const) (Link_web_chat_001._v2_const))))
let _v4_anon_fun_save_message _v2_extra_room _v62_extra_cont _v193_arg = let _v503_cont = (QmlCpsServerLib.ccont (_v62_extra_cont) ((Bsl_init_.clos_env_2 (_v2_clos_anon_fun_save_message) (_v62_extra_cont) (_v193_arg)))) in
let _v504_cont = (QmlCpsServerLib.ccont (_v503_cont) ((Bsl_init_.clos_env_2 (_v4_clos_anon_fun_save_message) (_v2_extra_room) (_v503_cont)))) in
let _v322_val = let _v210_arg = 0 in
((OpabslgenMLRuntime.Badoplink.key_int) (_v210_arg)) in
let _v507_cont = (QmlCpsServerLib.ccont (_v504_cont) ((Bsl_init_.clos_env_2 (_v6_clos_anon_fun_save_message) (_v504_cont) (_v322_val)))) in
let _v320_val = ((OpabslgenMLRuntime.Badoplink.key_string) (_v2_extra_room)) in
let _v509_cont = (QmlCpsServerLib.ccont (_v507_cont) ((Bsl_init_.clos_env_2 (_v8_clos_anon_fun_save_message) (_v507_cont) (_v320_val)))) in
let _v318_val = let _v215_arg = ( (* Eliminated vtable for field edge_root_0 *) (QmlFlatServerLib.unsafe_get (13) (Link_web_chat_002._v1_edge_map_))) in
((OpabslgenMLRuntime.Badoplink.key_int) (_v215_arg)) in
let _v513_cont = (QmlCpsServerLib.ccont (_v509_cont) ((Bsl_init_.clos_env_2 (_v10_clos_anon_fun_save_message) (_v509_cont) (_v318_val)))) in
let _v316_val = let _v218_arg = 1 in
((OpabslgenMLRuntime.Badoplink.key_int) (_v218_arg)) in
let _v314_val = OpabslgenMLRuntime.Badoplink.dbpath_root in
let _v315_val = (OpabslgenMLRuntime.Badoplink.dbpath_add (_v314_val) (_v316_val)) in
(QmlCpsServerLib.return (_v513_cont) (_v315_val))
let _v14_clos_anon_fun_save_message = ((Obj.magic) ((Bsl_init_.bslp26 (_v4_anon_fun_save_message) (3) (Link_web_chat_001._v161_const) (Link_web_chat_001._v2_const))))
let _v14_anon_fun_save_message _v11_extra_tr _v66_extra_cont _v196_arg = (Link_web_chat_002._v1_get_n3 (_v11_extra_tr) (_v196_arg) (_v66_extra_cont))
let _v15_clos_anon_fun_save_message = ((Obj.magic) ((Bsl_init_.bslp26 (_v14_anon_fun_save_message) (3) (Link_web_chat_001._v162_const) (Link_web_chat_001._v2_const))))
let _v13_anon_fun_save_message _v3_extra_room _v70_extra_cont _v33_tr = let _v482_cont = (QmlCpsServerLib.ccont (_v70_extra_cont) ((Bsl_init_.clos_env_2 (_v15_clos_anon_fun_save_message) (_v33_tr) (_v70_extra_cont)))) in
let _v303_val = let _v199_arg = 0 in
((OpabslgenMLRuntime.Badoplink.key_int) (_v199_arg)) in
let _v485_cont = (QmlCpsServerLib.ccont (_v482_cont) ((Bsl_init_.clos_env_2 (_v3_clos_anon_fun_save_message) (_v482_cont) (_v303_val)))) in
let _v301_val = ((OpabslgenMLRuntime.Badoplink.key_string) (_v3_extra_room)) in
let _v487_cont = (QmlCpsServerLib.ccont (_v485_cont) ((Bsl_init_.clos_env_2 (_v5_clos_anon_fun_save_message) (_v485_cont) (_v301_val)))) in
let _v299_val = let _v204_arg = ( (* Eliminated vtable for field edge_root_0 *) (QmlFlatServerLib.unsafe_get (13) (Link_web_chat_002._v1_edge_map_))) in
((OpabslgenMLRuntime.Badoplink.key_int) (_v204_arg)) in
let _v491_cont = (QmlCpsServerLib.ccont (_v487_cont) ((Bsl_init_.clos_env_2 (_v7_clos_anon_fun_save_message) (_v487_cont) (_v299_val)))) in
let _v297_val = let _v207_arg = 1 in
((OpabslgenMLRuntime.Badoplink.key_int) (_v207_arg)) in
let _v295_val = OpabslgenMLRuntime.Badoplink.dbpath_root in
let _v296_val = (OpabslgenMLRuntime.Badoplink.dbpath_add (_v295_val) (_v297_val)) in
(QmlCpsServerLib.return (_v491_cont) (_v296_val))
let _v16_clos_anon_fun_save_message = ((Obj.magic) ((Bsl_init_.bslp26 (_v13_anon_fun_save_message) (3) (Link_web_chat_001._v163_const) (Link_web_chat_001._v2_const))))
let _v1_save_message _v1_message _v1_room _v477_cont = let _v478_cont = (QmlCpsServerLib.ccont (_v477_cont) ((Bsl_init_.clos_env_2 (_v14_clos_anon_fun_save_message) (_v1_room) (_v477_cont)))) in
let _v479_cont = (QmlCpsServerLib.ccont (_v478_cont) ((Bsl_init_.clos_env_2 (_v13_clos_anon_fun_save_message) (_v1_message) (_v478_cont)))) in
let _v480_cont = (QmlCpsServerLib.ccont (_v479_cont) ((Bsl_init_.clos_env_2 (_v16_clos_anon_fun_save_message) (_v1_room) (_v479_cont)))) in
let _v481_cont = (QmlCpsServerLib.ccont (_v480_cont) ((Bsl_init_.clos_env_1 (_v9_clos_anon_fun_save_message) (_v480_cont)))) in
(OpabslgenMLRuntime.Opa_transaction.get_global_transaction_opt (Link_web_chat_002._v1__inaccessible_db_ident) (_v481_cont))
let _v0_anon_fun_welcome_message _v6_extra_author _v72_extra_cont _v341_val = (match ((QmlFlatServerLib.unwrap_record) (_v341_val)) with
_v4_true when (((==)) (((Obj.magic) (_v4_true))) (Link_web_chat_001._v0_simple_true)) -> let _v330_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (Link_web_chat_001._v164_const))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (((Opa_stdlib_2ecore_013._v0_identity_skip_ec6de8cf) (_v6_extra_author))))) ; (((Obj.repr) (Link_web_chat_001._v13_const))) |]))))) |])) in
(Opa_stdlib_2ecore_013._v1_sc_list_ec6de8cf (_v330_val) (_v72_extra_cont))
| _v4_false when (((==)) (((Obj.magic) (_v4_false))) (Link_web_chat_001._v0_simple_false)) -> let _v338_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (Link_web_chat_001._v167_const))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (((Opa_stdlib_2ecore_013._v0_identity_skip_ec6de8cf) (_v6_extra_author))))) ; (((Obj.repr) (Link_web_chat_001._v166_const))) |]))))) |])) in
(Opa_stdlib_2ecore_013._v1_sc_list_ec6de8cf (_v338_val) (_v72_extra_cont)))
let _v0_clos_anon_fun_welcome_message = ((Obj.magic) ((Bsl_init_.bslp26 (_v0_anon_fun_welcome_message) (3) (Link_web_chat_001._v168_const) (Link_web_chat_001._v2_const))))
let _v1_anon_fun_welcome_message _v7_extra_author _v73_extra_cont _v223_arg = let _v340_val = (Opa_stdlib_2ecore_013._v0_eq_skip_ec6de8cf (_v7_extra_author) (_v223_arg)) in
(QmlCpsServerLib.return (_v73_extra_cont) (_v340_val))
let _v1_clos_anon_fun_welcome_message = ((Obj.magic) ((Bsl_init_.bslp26 (_v1_anon_fun_welcome_message) (3) (Link_web_chat_001._v169_const) (Link_web_chat_001._v2_const))))
let _v1_welcome_message _v0_author _v519_cont = let _v535_cont = (QmlCpsServerLib.ccont (_v519_cont) ((Bsl_init_.clos_env_2 (_v0_clos_anon_fun_welcome_message) (_v0_author) (_v519_cont)))) in
let _v536_cont = (QmlCpsServerLib.ccont (_v535_cont) ((Bsl_init_.clos_env_2 (_v1_clos_anon_fun_welcome_message) (_v0_author) (_v535_cont)))) in
let _v339_val = let _v225_arg = Link_web_chat_001._v170_const in
((Opa_stdlib_2ecore_2exhtml_031._v0_select_id_skip_2b6d75d2) (_v225_arg)) in
(Opa_stdlib_2ecore_2exhtml_033._v1_get_value_2b6d75d2 (_v339_val) (_v536_cont))
let _v0_clos_welcome_message = ((Obj.magic) ((Bsl_init_.bslp26 (_v1_welcome_message) (2) (Link_web_chat_001._v171_const) (Link_web_chat_001._v142_const))))
let _v0_history_to_html_skip _v1_m = let _v1_remove_coerce = _v1_m in
let _v2_719f86eb = Opa_stdlib_2ecore_2exhtml_026._v2_ns_uri_2b6d75d2 in
((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["args" ; "content" ; "namespace" ; "specific_attributes" ; "tag"] *) Link_web_chat_001._v25_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (Link_web_chat_001._v13_const))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (Link_web_chat_001._v173_const))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["args" ; "content" ; "namespace" ; "specific_attributes" ; "tag"] *) Link_web_chat_001._v25_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (Link_web_chat_001._v13_const))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (Link_web_chat_001._v190_const))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (let _v226_arg = ( (* Eliminated vtable for field time *) (QmlFlatServerLib.unsafe_get (2) (_v1_m))) in
((Opa_stdlib_2ecore_2exhtml_026._v0_of_string_skip_2b6d75d2) (_v226_arg))))) ; (((Obj.repr) (Link_web_chat_001._v188_const))) |]))))) |]))))) ; (((Obj.repr) (_v2_719f86eb))) ; (((Obj.repr) (Link_web_chat_002._v194_const))) ; (((Obj.repr) (Link_web_chat_001._v179_const))) |]))))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (Link_web_chat_001._v173_const))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["args" ; "content" ; "namespace" ; "specific_attributes" ; "tag"] *) Link_web_chat_001._v25_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (Link_web_chat_001._v13_const))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (let _v227_arg = ( (* Eliminated vtable for field author *) (QmlFlatServerLib.unsafe_get (0) (_v1_m))) in
((Opa_stdlib_2ecore_2exhtml_026._v0_of_string_skip_2b6d75d2) (_v227_arg))))) ; (((Obj.repr) (Link_web_chat_001._v181_const))) |]))))) ; (((Obj.repr) (_v2_719f86eb))) ; (((Obj.repr) (Link_web_chat_001._v185_const))) ; (((Obj.repr) (Link_web_chat_001._v179_const))) |]))))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (Link_web_chat_001._v173_const))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["args" ; "content" ; "namespace" ; "specific_attributes" ; "tag"] *) Link_web_chat_001._v25_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (Link_web_chat_001._v13_const))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (let _v228_arg = ( (* Eliminated vtable for field text *) (QmlFlatServerLib.unsafe_get (1) (_v1_m))) in
((Opa_stdlib_2ecore_2exhtml_026._v0_of_string_skip_2b6d75d2) (_v228_arg))))) ; (((Obj.repr) (Link_web_chat_001._v13_const))) |]))))) ; (((Obj.repr) (_v2_719f86eb))) ; (((Obj.repr) (Link_web_chat_001._v178_const))) ; (((Obj.repr) (Link_web_chat_001._v179_const))) |]))))) ; (((Obj.repr) (Link_web_chat_001._v174_const))) |]))))) |]))))) |]))))) |]))))) |]))))) |]))))) ; (((Obj.repr) (_v2_719f86eb))) ; (((Obj.repr) (Link_web_chat_002._v198_const))) ; (((Obj.repr) (Link_web_chat_001._v179_const))) |]))
let _v1_history_to_html _v3_eta_0_1 _v661_cont = let _v455_val = ((_v0_history_to_html_skip) (_v3_eta_0_1)) in
(QmlCpsServerLib.return (_v661_cont) (_v455_val))
let _v0_clos_history_to_html = ((Obj.magic) ((Bsl_init_.bslp26 (_v1_history_to_html) (2) (Link_web_chat_002._v199_const) (Link_web_chat_001._v142_const))))
let _v0_message_to_html_skip _v0_m = let _v2_remove_coerce = _v0_m in
let _v1_719f86eb = Opa_stdlib_2ecore_2exhtml_026._v2_ns_uri_2b6d75d2 in
((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["args" ; "content" ; "namespace" ; "specific_attributes" ; "tag"] *) Link_web_chat_001._v25_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (Link_web_chat_001._v13_const))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (Link_web_chat_001._v173_const))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["args" ; "content" ; "namespace" ; "specific_attributes" ; "tag"] *) Link_web_chat_001._v25_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (Link_web_chat_001._v13_const))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (Link_web_chat_001._v190_const))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (let _v229_arg = ( (* Eliminated vtable for field time *) (QmlFlatServerLib.unsafe_get (2) (_v0_m))) in
((Opa_stdlib_2ecore_2exhtml_026._v0_of_string_skip_2b6d75d2) (_v229_arg))))) ; (((Obj.repr) (Link_web_chat_001._v188_const))) |]))))) |]))))) ; (((Obj.repr) (_v1_719f86eb))) ; (((Obj.repr) (Link_web_chat_002._v208_const))) ; (((Obj.repr) (Link_web_chat_001._v179_const))) |]))))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (Link_web_chat_001._v173_const))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["args" ; "content" ; "namespace" ; "specific_attributes" ; "tag"] *) Link_web_chat_001._v25_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (Link_web_chat_001._v13_const))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (let _v230_arg = ( (* Eliminated vtable for field author *) (QmlFlatServerLib.unsafe_get (0) (_v0_m))) in
((Opa_stdlib_2ecore_2exhtml_026._v0_of_string_skip_2b6d75d2) (_v230_arg))))) ; (((Obj.repr) (Link_web_chat_001._v181_const))) |]))))) ; (((Obj.repr) (_v1_719f86eb))) ; (((Obj.repr) (Link_web_chat_002._v205_const))) ; (((Obj.repr) (Link_web_chat_001._v179_const))) |]))))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (Link_web_chat_001._v173_const))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["args" ; "content" ; "namespace" ; "specific_attributes" ; "tag"] *) Link_web_chat_001._v25_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (Link_web_chat_001._v13_const))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (let _v231_arg = ( (* Eliminated vtable for field text *) (QmlFlatServerLib.unsafe_get (1) (_v0_m))) in
((Opa_stdlib_2ecore_2exhtml_026._v0_of_string_skip_2b6d75d2) (_v231_arg))))) ; (((Obj.repr) (Link_web_chat_001._v13_const))) |]))))) ; (((Obj.repr) (_v1_719f86eb))) ; (((Obj.repr) (Link_web_chat_002._v202_const))) ; (((Obj.repr) (Link_web_chat_001._v179_const))) |]))))) ; (((Obj.repr) (Link_web_chat_001._v174_const))) |]))))) |]))))) |]))))) |]))))) |]))))) |]))))) ; (((Obj.repr) (_v1_719f86eb))) ; (((Obj.repr) (Link_web_chat_002._v198_const))) ; (((Obj.repr) (Link_web_chat_001._v179_const))) |]))
let _v1_message_to_html _v4_eta_0_1 _v784_cont = let _v569_val = ((_v0_message_to_html_skip) (_v4_eta_0_1)) in
(QmlCpsServerLib.return (_v784_cont) (_v569_val))
let _v0_clos_message_to_html = ((Obj.magic) ((Bsl_init_.bslp26 (_v1_message_to_html) (2) (Link_web_chat_002._v209_const) (Link_web_chat_001._v142_const))))
let _v2_anon_fun_user_update _v74_extra_cont _v0___0__ = let _v591_val = let _v237_arg = Link_web_chat_002._v210_const in
((Opa_stdlib_2ecore_2exhtml_031._v0_select_id_skip_2b6d75d2) (_v237_arg)) in
(Opa_stdlib_2ecore_2exhtml_033._v2_scroll_to_top_2b6d75d2 (_v591_val) (_v74_extra_cont))
let _v0_clos_anon_fun_user_update = ((Obj.magic) ((Bsl_init_.bslp26 (_v2_anon_fun_user_update) (2) (Link_web_chat_002._v211_const) (Link_web_chat_001._v2_const))))
let _v1_anon_fun_user_update _v75_extra_cont _v0_line = let _v801_cont = (QmlCpsServerLib.ccont (_v75_extra_cont) ((Bsl_init_.clos_env_1 (_v0_clos_anon_fun_user_update) (_v75_extra_cont)))) in
let _v590_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["jq" ; "subject" ; "verb"] *) Link_web_chat_001._v27_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (let _v235_arg = Link_web_chat_002._v210_const in
((Opa_stdlib_2ecore_2exhtml_031._v0_select_id_skip_2b6d75d2) (_v235_arg))))) ; (((Obj.repr) (((QmlFlatServerLib.may_be_simple) ([| (((Obj.repr) (( (* ["content"] *) Link_web_chat_001._v26_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (((Opa_stdlib_2ecore_2exhtml_026._v0_to_xml_skip_2b6d75d2) (_v0_line))))) |]))))) ; (((Obj.repr) (Link_web_chat_002._v212_const))) |]))))) ; (((Obj.repr) (Link_web_chat_001._v13_const))) |])) in
(Opa_stdlib_2ecore_2exhtml_034._v3_transform_2b6d75d2 (_v590_val) (_v801_cont))
let _v1_clos_anon_fun_user_update = ((Obj.magic) ((Bsl_init_.bslp26 (_v1_anon_fun_user_update) (2) (Link_web_chat_002._v213_const) (Link_web_chat_001._v2_const))))
let _v3_anon_fun_user_update _v76_extra_cont _v233_arg = let _v581_val = ((_v0_message_to_html_skip) (_v233_arg)) in
(QmlCpsServerLib.return (_v76_extra_cont) (_v581_val))
let _v2_clos_anon_fun_user_update = ((Obj.magic) ((Bsl_init_.bslp26 (_v3_anon_fun_user_update) (2) (Link_web_chat_002._v214_const) (Link_web_chat_001._v2_const))))
let _v4_anon_fun_user_update _v0_extra_m _v0_extra_text _v77_extra_cont _v29_extra_val _v576_val = let _v579_val = ( (* Eliminated vtable for field welcome *) (QmlFlatServerLib.unsafe_get (3) (_v0_extra_m))) in
let _v578_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["author" ; "text" ; "time" ; "welcome"] *) Link_web_chat_001._v24_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v29_extra_val))) ; (((Obj.repr) (_v0_extra_text))) ; (((Obj.repr) (_v576_val))) ; (((Obj.repr) (_v579_val))) |])) in
(QmlCpsServerLib.return (_v77_extra_cont) (_v578_val))
let _v3_clos_anon_fun_user_update = ((Obj.magic) ((Bsl_init_.bslp26 (_v4_anon_fun_user_update) (5) (Link_web_chat_002._v215_const) (Link_web_chat_001._v2_const))))
let _v0_anon_fun_user_update _v1_extra_m _v78_extra_cont _v0_text = let _v793_cont = (QmlCpsServerLib.ccont (_v78_extra_cont) ((Bsl_init_.clos_env_1 (_v1_clos_anon_fun_user_update) (_v78_extra_cont)))) in
let _v794_cont = (QmlCpsServerLib.ccont (_v793_cont) ((Bsl_init_.clos_env_1 (_v2_clos_anon_fun_user_update) (_v793_cont)))) in
let _v580_val = ( (* Eliminated vtable for field author *) (QmlFlatServerLib.unsafe_get (0) (_v1_extra_m))) in
let _v798_cont = (QmlCpsServerLib.ccont (_v794_cont) ((Bsl_init_.clos_env_4 (_v3_clos_anon_fun_user_update) (_v1_extra_m) (_v0_text) (_v794_cont) (_v580_val)))) in
((_v1_stamp) (_v798_cont))
let _v4_clos_anon_fun_user_update = ((Obj.magic) ((Bsl_init_.bslp26 (_v0_anon_fun_user_update) (3) (Link_web_chat_002._v216_const) (Link_web_chat_001._v2_const))))
let _v1_user_update _v2_m _v785_cont = let _v787_cont = (QmlCpsServerLib.ccont (_v785_cont) ((Bsl_init_.clos_env_2 (_v4_clos_anon_fun_user_update) (_v2_m) (_v785_cont)))) in
let _v572_val = ( (* Eliminated vtable for field welcome *) (QmlFlatServerLib.unsafe_get (3) (_v2_m))) in
(match ((QmlFlatServerLib.unwrap_record) (_v572_val)) with
_v5_true when (((==)) (((Obj.magic) (_v5_true))) (Link_web_chat_001._v0_simple_true)) -> let _v570_val = ( (* Eliminated vtable for field author *) (QmlFlatServerLib.unsafe_get (0) (_v2_m))) in
(_v1_welcome_message (_v570_val) (_v787_cont))
| _v5_false when (((==)) (((Obj.magic) (_v5_false))) (Link_web_chat_001._v0_simple_false)) -> let _v571_val = ( (* Eliminated vtable for field text *) (QmlFlatServerLib.unsafe_get (1) (_v2_m))) in
(QmlCpsServerLib.return (_v787_cont) (_v571_val)))
let _v0_clos_user_update = ((Obj.magic) ((Bsl_init_.bslp26 (_v1_user_update) (2) (Link_web_chat_002._v217_const) (Link_web_chat_001._v142_const))))
let _v1_anon_fun_setup_conversation _v79_extra_cont _v238_arg = (Opa_stdlib_2ecore_2erpc_2ecore_018._v5_broadcast_f2f00d5f (Link_web_chat_002._v1_memo_ty) (_v238_arg) (_v2_room) (_v79_extra_cont))
let _v0_clos_anon_fun_setup_conversation = ((Obj.magic) ((Bsl_init_.bslp26 (_v1_anon_fun_setup_conversation) (2) (Link_web_chat_002._v218_const) (Link_web_chat_001._v2_const))))
let _v2_anon_fun_setup_conversation _v8_extra_author _v80_extra_cont _v30_extra_val _v594_val = let _v598_val = Link_web_chat_001._v142_const in
let _v597_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["author" ; "text" ; "time" ; "welcome"] *) Link_web_chat_001._v24_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v8_extra_author))) ; (((Obj.repr) (_v30_extra_val))) ; (((Obj.repr) (_v594_val))) ; (((Obj.repr) (_v598_val))) |])) in
(QmlCpsServerLib.return (_v80_extra_cont) (_v597_val))
let _v1_clos_anon_fun_setup_conversation = ((Obj.magic) ((Bsl_init_.bslp26 (_v2_anon_fun_setup_conversation) (4) (Link_web_chat_002._v219_const) (Link_web_chat_001._v2_const))))
let _v0_anon_fun_setup_conversation _v9_extra_author _v81_extra_cont _v0___1__ = let _v816_cont = (QmlCpsServerLib.ccont (_v81_extra_cont) ((Bsl_init_.clos_env_1 (_v0_clos_anon_fun_setup_conversation) (_v81_extra_cont)))) in
let _v599_val = Link_web_chat_001._v4_const in
let _v819_cont = (QmlCpsServerLib.ccont (_v816_cont) ((Bsl_init_.clos_env_3 (_v1_clos_anon_fun_setup_conversation) (_v9_extra_author) (_v816_cont) (_v599_val)))) in
((_v1_stamp) (_v819_cont))
let _v2_clos_anon_fun_setup_conversation = ((Obj.magic) ((Bsl_init_.bslp26 (_v0_anon_fun_setup_conversation) (3) (Link_web_chat_002._v220_const) (Link_web_chat_001._v2_const))))
let _v1_setup_conversation _v2_author _v814_cont = let _v815_cont = (QmlCpsServerLib.ccont (_v814_cont) ((Bsl_init_.clos_env_2 (_v2_clos_anon_fun_setup_conversation) (_v2_author) (_v814_cont)))) in
(Opa_stdlib_2ecore_2erpc_2ecore_018._v1_add_callback_f2f00d5f (Link_web_chat_002._v1_memo_ty) (_v0_clos_user_update) (_v2_room) (_v815_cont))
let _v0_clos_setup_conversation = ((Obj.magic) ((Bsl_init_.bslp26 (_v1_setup_conversation) (2) (Link_web_chat_002._v221_const) (Link_web_chat_001._v142_const))))
let _v2_anon_fun_broadcast _v82_extra_cont _v0___2__ = let _v608_val = let _v242_arg = Link_web_chat_002._v222_const in
((Opa_stdlib_2ecore_2exhtml_031._v0_select_id_skip_2b6d75d2) (_v242_arg)) in
(Opa_stdlib_2ecore_2exhtml_033._v1_clear_value_2b6d75d2 (_v608_val) (_v82_extra_cont))
let _v0_clos_anon_fun_broadcast = ((Obj.magic) ((Bsl_init_.bslp26 (_v2_anon_fun_broadcast) (2) (Link_web_chat_002._v223_const) (Link_web_chat_001._v2_const))))
let _v1_anon_fun_broadcast _v1_extra_message _v83_extra_cont _v0___3__ = let _v832_cont = (QmlCpsServerLib.ccont (_v83_extra_cont) ((Bsl_init_.clos_env_1 (_v0_clos_anon_fun_broadcast) (_v83_extra_cont)))) in
(Opa_stdlib_2ecore_2erpc_2ecore_018._v5_broadcast_f2f00d5f (Link_web_chat_002._v1_memo_ty) (_v1_extra_message) (_v2_room) (_v832_cont))
let _v1_clos_anon_fun_broadcast = ((Obj.magic) ((Bsl_init_.bslp26 (_v1_anon_fun_broadcast) (3) (Link_web_chat_002._v224_const) (Link_web_chat_001._v2_const))))
let _v0_anon_fun_broadcast _v4_extra_room_name _v84_extra_cont _v2_message = let _v831_cont = (QmlCpsServerLib.ccont (_v84_extra_cont) ((Bsl_init_.clos_env_2 (_v1_clos_anon_fun_broadcast) (_v2_message) (_v84_extra_cont)))) in
(_v1_save_message (_v2_message) (_v4_extra_room_name) (_v831_cont))
let _v2_clos_anon_fun_broadcast = ((Obj.magic) ((Bsl_init_.bslp26 (_v0_anon_fun_broadcast) (3) (Link_web_chat_002._v225_const) (Link_web_chat_001._v2_const))))
let _v4_anon_fun_broadcast _v10_extra_author _v85_extra_cont _v31_extra_val _v603_val = let _v607_val = Link_web_chat_001._v2_const in
let _v606_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["author" ; "text" ; "time" ; "welcome"] *) Link_web_chat_001._v24_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v10_extra_author))) ; (((Obj.repr) (_v31_extra_val))) ; (((Obj.repr) (_v603_val))) ; (((Obj.repr) (_v607_val))) |])) in
(QmlCpsServerLib.return (_v85_extra_cont) (_v606_val))
let _v3_clos_anon_fun_broadcast = ((Obj.magic) ((Bsl_init_.bslp26 (_v4_anon_fun_broadcast) (4) (Link_web_chat_002._v226_const) (Link_web_chat_001._v2_const))))
let _v3_anon_fun_broadcast _v11_extra_author _v86_extra_cont _v601_val = let _v828_cont = (QmlCpsServerLib.ccont (_v86_extra_cont) ((Bsl_init_.clos_env_3 (_v3_clos_anon_fun_broadcast) (_v11_extra_author) (_v86_extra_cont) (_v601_val)))) in
((_v1_stamp) (_v828_cont))
let _v4_clos_anon_fun_broadcast = ((Obj.magic) ((Bsl_init_.bslp26 (_v3_anon_fun_broadcast) (3) (Link_web_chat_002._v227_const) (Link_web_chat_001._v2_const))))
let _v1_broadcast _v3_author _v1_room_name _v822_cont = let _v823_cont = (QmlCpsServerLib.ccont (_v822_cont) ((Bsl_init_.clos_env_2 (_v2_clos_anon_fun_broadcast) (_v1_room_name) (_v822_cont)))) in
let _v825_cont = (QmlCpsServerLib.ccont (_v823_cont) ((Bsl_init_.clos_env_2 (_v4_clos_anon_fun_broadcast) (_v3_author) (_v823_cont)))) in
let _v602_val = let _v240_arg = Link_web_chat_002._v222_const in
((Opa_stdlib_2ecore_2exhtml_031._v0_select_id_skip_2b6d75d2) (_v240_arg)) in
(Opa_stdlib_2ecore_2exhtml_033._v1_get_value_2b6d75d2 (_v602_val) (_v825_cont))
let _v3_anon_fun_fun_action_body _v0_extra_extra_room_name _v0_extra_extra_author _v1_anonymous_lambda_arg_f1 _v835_cont = (_v1_broadcast (_v0_extra_extra_author) (_v0_extra_extra_room_name) (_v835_cont))
let _v0_clos_anon_fun_fun_action_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v3_anon_fun_fun_action_body) (4) (Link_web_chat_002._v228_const) (Link_web_chat_001._v2_const))))
let _v0_fun_action_body_skip _v0_extra_room_name _v2_extra_author = (Bsl_init_.clos_env_2 (_v0_clos_anon_fun_fun_action_body) (_v0_extra_room_name) (_v2_extra_author))
let _v4_fun_action_body _v0_eta_0_2 _v0_eta_1_2 _v837_cont = let _v609_val = (_v0_fun_action_body_skip (_v0_eta_0_2) (_v0_eta_1_2)) in
(QmlCpsServerLib.return (_v837_cont) (_v609_val))
let _v0_clos_fun_action_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v4_fun_action_body) (3) (Link_web_chat_002._v229_const) (Link_web_chat_001._v142_const))))
let _v2_anon_fun_stub_fun_action_eta_body _v0_extra_a1 _v0_extra_t1 _v88_extra_cont _v245_arg = (Opa_stdlib_2ecore_2erpc_2ecore_014._v1_OpaRPC_add_args_with_type_f2f00d5f (_v0_extra_t1) (_v0_extra_a1) (_v245_arg) (_v88_extra_cont))
let _v0_clos_anon_fun_stub_fun_action_eta_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v2_anon_fun_stub_fun_action_eta_body) (4) (Link_web_chat_002._v230_const) (Link_web_chat_001._v2_const))))
let _v1_anon_fun_stub_fun_action_eta_body _v0_extra_tres _v87_extra_cont _v244_arg = let _v610_val = Link_web_chat_002._v231_const in
(Opa_stdlib_2ecore_2erpc_2ecore_014._v1_OpaRPC_Server_send_to_client_f2f00d5f (_v610_val) (_v244_arg) (_v0_extra_tres) (_v87_extra_cont))
let _v1_clos_anon_fun_stub_fun_action_eta_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v1_anon_fun_stub_fun_action_eta_body) (3) (Link_web_chat_002._v232_const) (Link_web_chat_001._v2_const))))
let _v0_anon_fun_stub_fun_action_eta_body _v1_extra_a1 _v0_extra_a0 _v89_extra_cont _v619_val = (match ((QmlFlatServerLib.unwrap_record) (_v619_val)) with
[| _v15_vt ; _ ; lazy _v5_TyArrow_params ; lazy _v0_TyArrow_res |] when (((&&)) ((((==)) (((Obj.magic) (_v15_vt))) (( (* ["TyArrow_params" ; "TyArrow_res"] *) Link_web_chat_001._v8_shared_vtable)))) ((((&&)) ((((==)) (((QmlFlatServerLib.get_vtable) (((Obj.magic) (_v5_TyArrow_params))))) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) (let _v12_tl = (QmlFlatServerLib.unsafe_get (1) (((Obj.magic) (_v5_TyArrow_params)))) in
(((&&)) ((((==)) (((QmlFlatServerLib.get_vtable) (((Obj.magic) (_v12_tl))))) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) (let _v13_tl = (QmlFlatServerLib.unsafe_get (1) (((Obj.magic) (_v12_tl)))) in
(((==)) (((Obj.magic) (_v13_tl))) (Link_web_chat_001._v0_simple_nil)))))))) -> let _v0_t0 = (QmlFlatServerLib.unsafe_get (0) (((Obj.magic) (_v5_TyArrow_params)))) in
let _v14_tl = (QmlFlatServerLib.unsafe_get (1) (((Obj.magic) (_v5_TyArrow_params)))) in
let _v0_t1 = (QmlFlatServerLib.unsafe_get (0) (((Obj.magic) (_v14_tl)))) in
let _v0_tres = ((Obj.magic) (_v0_TyArrow_res)) in
let _v839_cont = (QmlCpsServerLib.ccont (_v89_extra_cont) ((Bsl_init_.clos_env_2 (_v1_clos_anon_fun_stub_fun_action_eta_body) (_v0_tres) (_v89_extra_cont)))) in
let _v840_cont = (QmlCpsServerLib.ccont (_v839_cont) ((Bsl_init_.clos_env_3 (_v0_clos_anon_fun_stub_fun_action_eta_body) (_v1_extra_a1) (_v0_t1) (_v839_cont)))) in
(Opa_stdlib_2ecore_2erpc_2ecore_014._v1_OpaRPC_add_args_with_type_f2f00d5f (_v0_t0) (_v0_extra_a0) (Opa_stdlib_2ecore_2erpc_2ecore_012._v1_OpaRPC_empty_request_f2f00d5f) (_v840_cont))
| _ -> let _v611_val = Link_web_chat_002._v231_const in
(Opa_stdlib_2ecore_2erpc_2ecore_012._v1_OpaRPC_error_stub_f2f00d5f (_v611_val) (_v89_extra_cont)))
let _v2_clos_anon_fun_stub_fun_action_eta_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v0_anon_fun_stub_fun_action_eta_body) (4) (Link_web_chat_002._v233_const) (Link_web_chat_001._v2_const))))
let _v0_stub_fun_action_eta_body _v0_a0 _v0_a1 _v838_cont = let _v843_cont = (QmlCpsServerLib.ccont (_v838_cont) ((Bsl_init_.clos_env_3 (_v2_clos_anon_fun_stub_fun_action_eta_body) (_v0_a1) (_v0_a0) (_v838_cont)))) in
let _v618_val = Link_web_chat_001._v20_const in
(Opa_stdlib_2ecore_2erpc_2ecore_012._v1_OpaTsc_implementation_f2f00d5f (_v618_val) (Link_web_chat_002._v14_memo_ty) (_v843_cont))
let _v0_clos_stub_fun_action_eta_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v0_stub_fun_action_eta_body) (3) (Link_web_chat_001._v8_const) (Link_web_chat_001._v142_const))))
let _v4_fun_action_eta_body _v0_fun_action_eta_body_eta_0 _v0_fun_action_eta_body_eta_1 _v851_cont = (_v0_stub_fun_action_eta_body (_v0_fun_action_eta_body_eta_0) (_v0_fun_action_eta_body_eta_1) (_v851_cont))
let _v0_clos_fun_action_eta_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v4_fun_action_eta_body) (3) (Link_web_chat_001._v8_const) (Link_web_chat_001._v142_const))))
let _v4_anon_fun_fun_action_body _v2_extra_extra_room_name _v2_extra_extra_author _v2_anonymous_lambda_arg_f1 _v852_cont = (_v1_broadcast (_v2_extra_extra_author) (_v2_extra_extra_room_name) (_v852_cont))
let _v1_clos_anon_fun_fun_action_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v4_anon_fun_fun_action_body) (4) (Link_web_chat_002._v234_const) (Link_web_chat_001._v2_const))))
let _v1_fun_action_body_skip _v2_extra_room_name _v4_extra_author = (Bsl_init_.clos_env_2 (_v1_clos_anon_fun_fun_action_body) (_v2_extra_room_name) (_v4_extra_author))
let _v5_fun_action_body _v1_eta_0_2 _v1_eta_1_2 _v854_cont = let _v620_val = (_v1_fun_action_body_skip (_v1_eta_0_2) (_v1_eta_1_2)) in
(QmlCpsServerLib.return (_v854_cont) (_v620_val))
let _v1_clos_fun_action_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v5_fun_action_body) (3) (Link_web_chat_002._v235_const) (Link_web_chat_001._v142_const))))
let _v4_anon_fun_stub_fun_action_eta_body _v1_extra_tres _v90_extra_cont _v249_arg = let _v621_val = Link_web_chat_002._v236_const in
(Opa_stdlib_2ecore_2erpc_2ecore_014._v1_OpaRPC_Server_send_to_client_f2f00d5f (_v621_val) (_v249_arg) (_v1_extra_tres) (_v90_extra_cont))
let _v3_clos_anon_fun_stub_fun_action_eta_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v4_anon_fun_stub_fun_action_eta_body) (3) (Link_web_chat_002._v237_const) (Link_web_chat_001._v2_const))))
let _v5_anon_fun_stub_fun_action_eta_body _v2_extra_a1 _v1_extra_t1 _v91_extra_cont _v250_arg = (Opa_stdlib_2ecore_2erpc_2ecore_014._v1_OpaRPC_add_args_with_type_f2f00d5f (_v1_extra_t1) (_v2_extra_a1) (_v250_arg) (_v91_extra_cont))
let _v4_clos_anon_fun_stub_fun_action_eta_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v5_anon_fun_stub_fun_action_eta_body) (4) (Link_web_chat_002._v238_const) (Link_web_chat_001._v2_const))))
let _v3_anon_fun_stub_fun_action_eta_body _v3_extra_a1 _v1_extra_a0 _v92_extra_cont _v630_val = (match ((QmlFlatServerLib.unwrap_record) (_v630_val)) with
[| _v16_vt ; _ ; lazy _v6_TyArrow_params ; lazy _v1_TyArrow_res |] when (((&&)) ((((==)) (((Obj.magic) (_v16_vt))) (( (* ["TyArrow_params" ; "TyArrow_res"] *) Link_web_chat_001._v8_shared_vtable)))) ((((&&)) ((((==)) (((QmlFlatServerLib.get_vtable) (((Obj.magic) (_v6_TyArrow_params))))) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) (let _v16_tl = (QmlFlatServerLib.unsafe_get (1) (((Obj.magic) (_v6_TyArrow_params)))) in
(((&&)) ((((==)) (((QmlFlatServerLib.get_vtable) (((Obj.magic) (_v16_tl))))) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) (let _v17_tl = (QmlFlatServerLib.unsafe_get (1) (((Obj.magic) (_v16_tl)))) in
(((==)) (((Obj.magic) (_v17_tl))) (Link_web_chat_001._v0_simple_nil)))))))) -> let _v1_t0 = (QmlFlatServerLib.unsafe_get (0) (((Obj.magic) (_v6_TyArrow_params)))) in
let _v18_tl = (QmlFlatServerLib.unsafe_get (1) (((Obj.magic) (_v6_TyArrow_params)))) in
let _v1_t1 = (QmlFlatServerLib.unsafe_get (0) (((Obj.magic) (_v18_tl)))) in
let _v1_tres = ((Obj.magic) (_v1_TyArrow_res)) in
let _v856_cont = (QmlCpsServerLib.ccont (_v92_extra_cont) ((Bsl_init_.clos_env_2 (_v3_clos_anon_fun_stub_fun_action_eta_body) (_v1_tres) (_v92_extra_cont)))) in
let _v857_cont = (QmlCpsServerLib.ccont (_v856_cont) ((Bsl_init_.clos_env_3 (_v4_clos_anon_fun_stub_fun_action_eta_body) (_v3_extra_a1) (_v1_t1) (_v856_cont)))) in
(Opa_stdlib_2ecore_2erpc_2ecore_014._v1_OpaRPC_add_args_with_type_f2f00d5f (_v1_t0) (_v1_extra_a0) (Opa_stdlib_2ecore_2erpc_2ecore_012._v1_OpaRPC_empty_request_f2f00d5f) (_v857_cont))
| _ -> let _v622_val = Link_web_chat_002._v236_const in
(Opa_stdlib_2ecore_2erpc_2ecore_012._v1_OpaRPC_error_stub_f2f00d5f (_v622_val) (_v92_extra_cont)))
let _v5_clos_anon_fun_stub_fun_action_eta_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v3_anon_fun_stub_fun_action_eta_body) (4) (Link_web_chat_002._v239_const) (Link_web_chat_001._v2_const))))
let _v1_stub_fun_action_eta_body _v1_a0 _v1_a1 _v855_cont = let _v860_cont = (QmlCpsServerLib.ccont (_v855_cont) ((Bsl_init_.clos_env_3 (_v5_clos_anon_fun_stub_fun_action_eta_body) (_v1_a1) (_v1_a0) (_v855_cont)))) in
let _v629_val = Link_web_chat_001._v20_const in
(Opa_stdlib_2ecore_2erpc_2ecore_012._v1_OpaTsc_implementation_f2f00d5f (_v629_val) (Link_web_chat_002._v14_memo_ty) (_v860_cont))
let _v1_clos_stub_fun_action_eta_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v1_stub_fun_action_eta_body) (3) (Link_web_chat_001._v7_const) (Link_web_chat_001._v142_const))))
let _v5_fun_action_eta_body _v1_fun_action_eta_body_eta_0 _v1_fun_action_eta_body_eta_1 _v868_cont = (_v1_stub_fun_action_eta_body (_v1_fun_action_eta_body_eta_0) (_v1_fun_action_eta_body_eta_1) (_v868_cont))
let _v1_clos_fun_action_eta_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v5_fun_action_eta_body) (3) (Link_web_chat_001._v7_const) (Link_web_chat_001._v142_const))))
let _v5_anon_fun_fun_action_body _v4_extra_extra_author _v0_anonymous_lambda_arg_f1 _v869_cont = (_v1_setup_conversation (_v4_extra_extra_author) (_v869_cont))
let _v2_clos_anon_fun_fun_action_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v5_anon_fun_fun_action_body) (3) (Link_web_chat_002._v240_const) (Link_web_chat_001._v142_const))))
let _v2_fun_action_body_skip _v0_extra_author = (Bsl_init_.clos_env_1 (_v2_clos_anon_fun_fun_action_body) (_v0_extra_author))
let _v3_fun_action_body _v5_eta_0_1 _v871_cont = let _v631_val = ((_v2_fun_action_body_skip) (_v5_eta_0_1)) in
(QmlCpsServerLib.return (_v871_cont) (_v631_val))
let _v2_clos_fun_action_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v3_fun_action_body) (2) (Link_web_chat_002._v241_const) (Link_web_chat_001._v142_const))))
let _v7_anon_fun_stub_fun_action_eta_body _v2_extra_tres _v93_extra_cont _v254_arg = let _v632_val = Link_web_chat_002._v242_const in
(Opa_stdlib_2ecore_2erpc_2ecore_014._v1_OpaRPC_Server_send_to_client_f2f00d5f (_v632_val) (_v254_arg) (_v2_extra_tres) (_v93_extra_cont))
let _v6_clos_anon_fun_stub_fun_action_eta_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v7_anon_fun_stub_fun_action_eta_body) (3) (Link_web_chat_002._v243_const) (Link_web_chat_001._v2_const))))
let _v6_anon_fun_stub_fun_action_eta_body _v2_extra_a0 _v94_extra_cont _v641_val = (match ((QmlFlatServerLib.unwrap_record) (_v641_val)) with
[| _v17_vt ; _ ; lazy _v7_TyArrow_params ; lazy _v2_TyArrow_res |] when (((&&)) ((((==)) (((Obj.magic) (_v17_vt))) (( (* ["TyArrow_params" ; "TyArrow_res"] *) Link_web_chat_001._v8_shared_vtable)))) ((((&&)) ((((==)) (((QmlFlatServerLib.get_vtable) (((Obj.magic) (_v7_TyArrow_params))))) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) (let _v20_tl = (QmlFlatServerLib.unsafe_get (1) (((Obj.magic) (_v7_TyArrow_params)))) in
(((==)) (((Obj.magic) (_v20_tl))) (Link_web_chat_001._v0_simple_nil)))))) -> let _v2_t0 = (QmlFlatServerLib.unsafe_get (0) (((Obj.magic) (_v7_TyArrow_params)))) in
let _v2_tres = ((Obj.magic) (_v2_TyArrow_res)) in
let _v873_cont = (QmlCpsServerLib.ccont (_v94_extra_cont) ((Bsl_init_.clos_env_2 (_v6_clos_anon_fun_stub_fun_action_eta_body) (_v2_tres) (_v94_extra_cont)))) in
(Opa_stdlib_2ecore_2erpc_2ecore_014._v1_OpaRPC_add_args_with_type_f2f00d5f (_v2_t0) (_v2_extra_a0) (Opa_stdlib_2ecore_2erpc_2ecore_012._v1_OpaRPC_empty_request_f2f00d5f) (_v873_cont))
| _ -> let _v633_val = Link_web_chat_002._v242_const in
(Opa_stdlib_2ecore_2erpc_2ecore_012._v1_OpaRPC_error_stub_f2f00d5f (_v633_val) (_v94_extra_cont)))
let _v7_clos_anon_fun_stub_fun_action_eta_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v6_anon_fun_stub_fun_action_eta_body) (3) (Link_web_chat_002._v244_const) (Link_web_chat_001._v2_const))))
let _v2_stub_fun_action_eta_body _v2_a0 _v872_cont = let _v876_cont = (QmlCpsServerLib.ccont (_v872_cont) ((Bsl_init_.clos_env_2 (_v7_clos_anon_fun_stub_fun_action_eta_body) (_v2_a0) (_v872_cont)))) in
let _v640_val = Link_web_chat_001._v20_const in
(Opa_stdlib_2ecore_2erpc_2ecore_012._v1_OpaTsc_implementation_f2f00d5f (_v640_val) (Link_web_chat_002._v16_memo_ty) (_v876_cont))
let _v2_clos_stub_fun_action_eta_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v2_stub_fun_action_eta_body) (2) (Link_web_chat_001._v9_const) (Link_web_chat_001._v142_const))))
let _v3_fun_action_eta_body _v2_fun_action_eta_body_eta_0 _v884_cont = (_v2_stub_fun_action_eta_body (_v2_fun_action_eta_body_eta_0) (_v884_cont))
let _v2_clos_fun_action_eta_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v3_fun_action_eta_body) (2) (Link_web_chat_001._v9_const) (Link_web_chat_001._v142_const))))
let _v3_anon_fun_body _v98_extra_cont _v33_extra_val _v695_val = let _v917_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v33_extra_val))) ; (((Obj.repr) (_v695_val))) |])) in
(QmlCpsServerLib.return (_v98_extra_cont) (_v917_val))
let _v0_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v3_anon_fun_body) (3) (Link_web_chat_002._v245_const) (Link_web_chat_001._v2_const))))
let _v24_anon_fun_body _v118_extra_cont _v48_extra_val _v49_extra_val _v794_val = let _v823_val = Link_web_chat_001._v13_const in
let _v822_val = Link_web_chat_001._v81_const in
let _v821_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["class" ; "events" ; "events_options" ; "href" ; "style"] *) Link_web_chat_001._v17_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v49_extra_val))) ; (((Obj.repr) (_v794_val))) ; (((Obj.repr) (_v823_val))) ; (((Obj.repr) (_v822_val))) ; (((Obj.repr) (_v48_extra_val))) |])) in
(QmlCpsServerLib.return (_v118_extra_cont) (_v821_val))
let _v1_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v24_anon_fun_body) (4) (Link_web_chat_002._v246_const) (Link_web_chat_001._v2_const))))
let _v25_anon_fun_body _v119_extra_cont _v795_val = let _v816_val = Link_web_chat_001._v13_const in
let _v815_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v795_val))) ; (((Obj.repr) (_v816_val))) |])) in
(QmlCpsServerLib.return (_v119_extra_cont) (_v815_val))
let _v2_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v25_anon_fun_body) (2) (Link_web_chat_002._v247_const) (Link_web_chat_001._v2_const))))
let _v5_anon_fun_body _v99_extra_cont _v34_extra_val _v760_val = let _v916_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v34_extra_val))) ; (((Obj.repr) (_v760_val))) |])) in
(QmlCpsServerLib.return (_v99_extra_cont) (_v916_val))
let _v3_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v5_anon_fun_body) (3) (Link_web_chat_002._v248_const) (Link_web_chat_001._v2_const))))
let _v6_anon_fun_body _v100_extra_cont _v35_extra_val _v763_val = let _v914_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v35_extra_val))) ; (((Obj.repr) (_v763_val))) |])) in
(QmlCpsServerLib.return (_v100_extra_cont) (_v914_val))
let _v4_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v6_anon_fun_body) (3) (Link_web_chat_002._v249_const) (Link_web_chat_001._v2_const))))
let _v7_anon_fun_body _v101_extra_cont _v764_val = let _v913_val = Link_web_chat_001._v13_const in
let _v912_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v764_val))) ; (((Obj.repr) (_v913_val))) |])) in
(QmlCpsServerLib.return (_v101_extra_cont) (_v912_val))
let _v5_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v7_anon_fun_body) (2) (Link_web_chat_002._v250_const) (Link_web_chat_001._v2_const))))
let _v8_anon_fun_body _v102_extra_cont _v36_extra_val _v37_extra_val _v774_val = let _v907_val = Link_web_chat_001._v81_const in
let _v906_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["args" ; "content" ; "namespace" ; "specific_attributes" ; "tag"] *) Link_web_chat_001._v25_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v36_extra_val))) ; (((Obj.repr) (_v774_val))) ; (((Obj.repr) (Opa_stdlib_2ecore_2exhtml_026._v2_ns_uri_2b6d75d2))) ; (((Obj.repr) (_v907_val))) ; (((Obj.repr) (_v37_extra_val))) |])) in
(QmlCpsServerLib.return (_v102_extra_cont) (_v906_val))
let _v6_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v8_anon_fun_body) (4) (Link_web_chat_002._v251_const) (Link_web_chat_001._v2_const))))
let _v9_anon_fun_body _v103_extra_cont _v38_extra_val _v777_val = let _v902_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v38_extra_val))) ; (((Obj.repr) (_v777_val))) |])) in
(QmlCpsServerLib.return (_v103_extra_cont) (_v902_val))
let _v7_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v9_anon_fun_body) (3) (Link_web_chat_002._v252_const) (Link_web_chat_001._v2_const))))
let _v11_anon_fun_body _v104_extra_cont _v39_extra_val _v833_val = let _v901_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v39_extra_val))) ; (((Obj.repr) (_v833_val))) |])) in
(QmlCpsServerLib.return (_v104_extra_cont) (_v901_val))
let _v8_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v11_anon_fun_body) (3) (Link_web_chat_002._v253_const) (Link_web_chat_001._v2_const))))
let _v12_anon_fun_body _v105_extra_cont _v40_extra_val _v836_val = let _v899_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v40_extra_val))) ; (((Obj.repr) (_v836_val))) |])) in
(QmlCpsServerLib.return (_v105_extra_cont) (_v899_val))
let _v9_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v12_anon_fun_body) (3) (Link_web_chat_002._v254_const) (Link_web_chat_001._v2_const))))
let _v13_anon_fun_body _v106_extra_cont _v837_val = let _v898_val = Link_web_chat_001._v174_const in
let _v897_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v837_val))) ; (((Obj.repr) (_v898_val))) |])) in
(QmlCpsServerLib.return (_v106_extra_cont) (_v897_val))
let _v10_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v13_anon_fun_body) (2) (Link_web_chat_002._v255_const) (Link_web_chat_001._v2_const))))
let _v14_anon_fun_body _v107_extra_cont _v41_extra_val _v42_extra_val _v842_val = let _v889_val = Link_web_chat_002._v258_const in
let _v888_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["args" ; "content" ; "namespace" ; "specific_attributes" ; "tag"] *) Link_web_chat_001._v25_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v41_extra_val))) ; (((Obj.repr) (_v889_val))) ; (((Obj.repr) (Opa_stdlib_2ecore_2exhtml_026._v2_ns_uri_2b6d75d2))) ; (((Obj.repr) (_v842_val))) ; (((Obj.repr) (_v42_extra_val))) |])) in
(QmlCpsServerLib.return (_v107_extra_cont) (_v888_val))
let _v11_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v14_anon_fun_body) (4) (Link_web_chat_002._v259_const) (Link_web_chat_001._v2_const))))
let _v15_anon_fun_body _v108_extra_cont _v843_val = let _v882_val = ((QmlFlatServerLib.may_be_simple) ([| (((Obj.repr) (( (* ["some"] *) Link_web_chat_001._v18_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v843_val))) |])) in
(QmlCpsServerLib.return (_v108_extra_cont) (_v882_val))
let _v12_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v15_anon_fun_body) (2) (Link_web_chat_002._v260_const) (Link_web_chat_001._v2_const))))
let _v16_anon_fun_body _v109_extra_cont _v43_extra_val _v44_extra_val _v850_val = let _v879_val = Link_web_chat_001._v13_const in
let _v878_val = Link_web_chat_001._v81_const in
let _v877_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["class" ; "events" ; "events_options" ; "href" ; "style"] *) Link_web_chat_001._v17_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v44_extra_val))) ; (((Obj.repr) (_v850_val))) ; (((Obj.repr) (_v879_val))) ; (((Obj.repr) (_v878_val))) ; (((Obj.repr) (_v43_extra_val))) |])) in
(QmlCpsServerLib.return (_v109_extra_cont) (_v877_val))
let _v13_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v16_anon_fun_body) (4) (Link_web_chat_002._v261_const) (Link_web_chat_001._v2_const))))
let _v17_anon_fun_body _v110_extra_cont _v851_val = let _v872_val = Link_web_chat_001._v13_const in
let _v871_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v851_val))) ; (((Obj.repr) (_v872_val))) |])) in
(QmlCpsServerLib.return (_v110_extra_cont) (_v871_val))
let _v14_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v17_anon_fun_body) (2) (Link_web_chat_002._v262_const) (Link_web_chat_001._v2_const))))
let _v18_anon_fun_body _v111_extra_cont _v45_extra_val _v854_val = let _v867_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["name" ; "value"] *) Link_web_chat_001._v28_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v45_extra_val))) ; (((Obj.repr) (_v854_val))) |])) in
(QmlCpsServerLib.return (_v111_extra_cont) (_v867_val))
let _v15_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v18_anon_fun_body) (3) (Link_web_chat_002._v263_const) (Link_web_chat_001._v2_const))))
let _v19_anon_fun_body _v112_extra_cont _v855_val = let _v866_val = ((QmlFlatServerLib.may_be_simple) ([| (((Obj.repr) (( (* ["value"] *) Link_web_chat_001._v29_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v855_val))) |])) in
(QmlCpsServerLib.return (_v112_extra_cont) (_v866_val))
let _v16_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v19_anon_fun_body) (2) (Link_web_chat_002._v264_const) (Link_web_chat_001._v2_const))))
let _v21_anon_fun_body _v2_extra_arg _v113_extra_cont _v4_arg = let _v865_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v2_extra_arg))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v4_arg))) ; (((Obj.repr) (Link_web_chat_001._v13_const))) |]))))) |])) in
let _v864_val = Link_web_chat_001._v13_const in
(Opa_stdlib_2ecore_2efunaction_001._v1_FunActionServer_serialize_call_0ceeb04a (Link_web_chat_002._v0___v8_fun_action_eta_body) (_v864_val) (_v865_val) (_v113_extra_cont))
let _v17_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v21_anon_fun_body) (3) (Link_web_chat_002._v265_const) (Link_web_chat_001._v2_const))))
let _v20_anon_fun_body _v12_extra_author _v114_extra_cont _v3_arg = let _v1075_cont = (QmlCpsServerLib.ccont (_v114_extra_cont) ((Bsl_init_.clos_env_2 (_v17_clos_anon_fun_body) (_v3_arg) (_v114_extra_cont)))) in
let _v857_val = Link_web_chat_002._v266_const in
(Opa_stdlib_2ecore_2efunaction_001._v1_FunActionServer_serialize_argument_0ceeb04a (Link_web_chat_002._v2_memo_ty) (_v857_val) (_v12_extra_author) (_v1075_cont))
let _v18_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v20_anon_fun_body) (3) (Link_web_chat_002._v267_const) (Link_web_chat_001._v2_const))))
let _v10_anon_fun_body _v5_extra_room_name _v13_extra_author _v115_extra_cont _v778_val = let _v1050_cont = (QmlCpsServerLib.ccont (_v115_extra_cont) ((Bsl_init_.clos_env_2 (_v8_clos_anon_fun_body) (_v115_extra_cont) (_v778_val)))) in
let _v900_val = Link_web_chat_001._v173_const in
let _v1053_cont = (QmlCpsServerLib.ccont (_v1050_cont) ((Bsl_init_.clos_env_2 (_v9_clos_anon_fun_body) (_v1050_cont) (_v900_val)))) in
let _v1054_cont = (QmlCpsServerLib.ccont (_v1053_cont) ((Bsl_init_.clos_env_1 (_v10_clos_anon_fun_body) (_v1053_cont)))) in
let _v891_val = Link_web_chat_001._v179_const in
let _v890_val = Link_web_chat_001._v13_const in
let _v1059_cont = (QmlCpsServerLib.ccont (_v1054_cont) ((Bsl_init_.clos_env_3 (_v11_clos_anon_fun_body) (_v1054_cont) (_v890_val) (_v891_val)))) in
let _v1060_cont = (QmlCpsServerLib.ccont (_v1059_cont) ((Bsl_init_.clos_env_1 (_v12_clos_anon_fun_body) (_v1059_cont)))) in
let _v881_val = Link_web_chat_002._v269_const in
let _v880_val = Link_web_chat_001._v13_const in
let _v1067_cont = (QmlCpsServerLib.ccont (_v1060_cont) ((Bsl_init_.clos_env_3 (_v13_clos_anon_fun_body) (_v1060_cont) (_v880_val) (_v881_val)))) in
let _v1068_cont = (QmlCpsServerLib.ccont (_v1067_cont) ((Bsl_init_.clos_env_1 (_v14_clos_anon_fun_body) (_v1067_cont)))) in
let _v868_val = Link_web_chat_002._v270_const in
let _v1071_cont = (QmlCpsServerLib.ccont (_v1068_cont) ((Bsl_init_.clos_env_2 (_v15_clos_anon_fun_body) (_v1068_cont) (_v868_val)))) in
let _v1072_cont = (QmlCpsServerLib.ccont (_v1071_cont) ((Bsl_init_.clos_env_1 (_v16_clos_anon_fun_body) (_v1071_cont)))) in
let _v1073_cont = (QmlCpsServerLib.ccont (_v1072_cont) ((Bsl_init_.clos_env_2 (_v18_clos_anon_fun_body) (_v13_extra_author) (_v1072_cont)))) in
let _v856_val = Link_web_chat_002._v266_const in
(Opa_stdlib_2ecore_2efunaction_001._v1_FunActionServer_serialize_argument_0ceeb04a (Link_web_chat_002._v2_memo_ty) (_v856_val) (_v5_extra_room_name) (_v1073_cont))
let _v19_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v10_anon_fun_body) (4) (Link_web_chat_002._v271_const) (Link_web_chat_001._v2_const))))
let _v22_anon_fun_body _v116_extra_cont _v46_extra_val _v47_extra_val _v788_val = let _v830_val = Link_web_chat_001._v13_const in
let _v829_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["args" ; "content" ; "namespace" ; "specific_attributes" ; "tag"] *) Link_web_chat_001._v25_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v46_extra_val))) ; (((Obj.repr) (_v830_val))) ; (((Obj.repr) (Opa_stdlib_2ecore_2exhtml_026._v2_ns_uri_2b6d75d2))) ; (((Obj.repr) (_v788_val))) ; (((Obj.repr) (_v47_extra_val))) |])) in
(QmlCpsServerLib.return (_v116_extra_cont) (_v829_val))
let _v20_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v22_anon_fun_body) (4) (Link_web_chat_002._v272_const) (Link_web_chat_001._v2_const))))
let _v23_anon_fun_body _v117_extra_cont _v789_val = let _v826_val = ((QmlFlatServerLib.may_be_simple) ([| (((Obj.repr) (( (* ["some"] *) Link_web_chat_001._v18_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v789_val))) |])) in
(QmlCpsServerLib.return (_v117_extra_cont) (_v826_val))
let _v21_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v23_anon_fun_body) (2) (Link_web_chat_002._v273_const) (Link_web_chat_001._v2_const))))
let _v26_anon_fun_body _v120_extra_cont _v50_extra_val _v798_val = let _v811_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["name" ; "value"] *) Link_web_chat_001._v28_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v50_extra_val))) ; (((Obj.repr) (_v798_val))) |])) in
(QmlCpsServerLib.return (_v120_extra_cont) (_v811_val))
let _v22_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v26_anon_fun_body) (3) (Link_web_chat_002._v274_const) (Link_web_chat_001._v2_const))))
let _v27_anon_fun_body _v121_extra_cont _v799_val = let _v810_val = ((QmlFlatServerLib.may_be_simple) ([| (((Obj.repr) (( (* ["value"] *) Link_web_chat_001._v29_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v799_val))) |])) in
(QmlCpsServerLib.return (_v121_extra_cont) (_v810_val))
let _v23_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v27_anon_fun_body) (2) (Link_web_chat_002._v275_const) (Link_web_chat_001._v2_const))))
let _v29_anon_fun_body _v3_extra_arg _v122_extra_cont _v2_arg = let _v809_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v3_extra_arg))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v2_arg))) ; (((Obj.repr) (Link_web_chat_001._v13_const))) |]))))) |])) in
let _v808_val = Link_web_chat_001._v13_const in
(Opa_stdlib_2ecore_2efunaction_001._v1_FunActionServer_serialize_call_0ceeb04a (Link_web_chat_002._v0___v7_fun_action_eta_body) (_v808_val) (_v809_val) (_v122_extra_cont))
let _v24_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v29_anon_fun_body) (3) (Link_web_chat_002._v276_const) (Link_web_chat_001._v2_const))))
let _v28_anon_fun_body _v14_extra_author _v123_extra_cont _v1_arg = let _v1032_cont = (QmlCpsServerLib.ccont (_v123_extra_cont) ((Bsl_init_.clos_env_2 (_v24_clos_anon_fun_body) (_v1_arg) (_v123_extra_cont)))) in
let _v801_val = Link_web_chat_002._v266_const in
(Opa_stdlib_2ecore_2efunaction_001._v1_FunActionServer_serialize_argument_0ceeb04a (Link_web_chat_002._v2_memo_ty) (_v801_val) (_v14_extra_author) (_v1032_cont))
let _v25_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v28_anon_fun_body) (3) (Link_web_chat_002._v277_const) (Link_web_chat_001._v2_const))))
let _v4_anon_fun_body _v6_extra_room_name _v15_extra_author _v124_extra_cont _v696_val = let _v990_cont = (QmlCpsServerLib.ccont (_v124_extra_cont) ((Bsl_init_.clos_env_2 (_v3_clos_anon_fun_body) (_v124_extra_cont) (_v696_val)))) in
let _v915_val = Link_web_chat_002._v279_const in
let _v993_cont = (QmlCpsServerLib.ccont (_v990_cont) ((Bsl_init_.clos_env_2 (_v4_clos_anon_fun_body) (_v990_cont) (_v915_val)))) in
let _v994_cont = (QmlCpsServerLib.ccont (_v993_cont) ((Bsl_init_.clos_env_1 (_v5_clos_anon_fun_body) (_v993_cont)))) in
let _v909_val = Link_web_chat_001._v179_const in
let _v908_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["name" ; "namespace" ; "value"] *) Link_web_chat_001._v30_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (Link_web_chat_002._v281_const))) ; (((Obj.repr) (Opa_stdlib_2ecore_2exhtml_026._v2_ns_uri_2b6d75d2))) ; (((Obj.repr) (Link_web_chat_002._v280_const))) |]))))) ; (((Obj.repr) (Link_web_chat_001._v13_const))) |])) in
let _v1004_cont = (QmlCpsServerLib.ccont (_v994_cont) ((Bsl_init_.clos_env_3 (_v6_clos_anon_fun_body) (_v994_cont) (_v908_val) (_v909_val)))) in
let _v903_val = Link_web_chat_001._v173_const in
let _v1007_cont = (QmlCpsServerLib.ccont (_v1004_cont) ((Bsl_init_.clos_env_2 (_v7_clos_anon_fun_body) (_v1004_cont) (_v903_val)))) in
let _v1008_cont = (QmlCpsServerLib.ccont (_v1007_cont) ((Bsl_init_.clos_env_3 (_v19_clos_anon_fun_body) (_v6_extra_room_name) (_v15_extra_author) (_v1007_cont)))) in
let _v832_val = Link_web_chat_002._v282_const in
let _v831_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["name" ; "namespace" ; "value"] *) Link_web_chat_001._v30_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (Link_web_chat_002._v281_const))) ; (((Obj.repr) (Opa_stdlib_2ecore_2exhtml_026._v2_ns_uri_2b6d75d2))) ; (((Obj.repr) (Link_web_chat_002._v222_const))) |]))))) ; (((Obj.repr) (Link_web_chat_001._v13_const))) |])) in
let _v1018_cont = (QmlCpsServerLib.ccont (_v1008_cont) ((Bsl_init_.clos_env_3 (_v20_clos_anon_fun_body) (_v1008_cont) (_v831_val) (_v832_val)))) in
let _v1019_cont = (QmlCpsServerLib.ccont (_v1018_cont) ((Bsl_init_.clos_env_1 (_v21_clos_anon_fun_body) (_v1018_cont)))) in
let _v825_val = Link_web_chat_001._v13_const in
let _v824_val = Link_web_chat_001._v13_const in
let _v1024_cont = (QmlCpsServerLib.ccont (_v1019_cont) ((Bsl_init_.clos_env_3 (_v1_clos_anon_fun_body) (_v1019_cont) (_v824_val) (_v825_val)))) in
let _v1025_cont = (QmlCpsServerLib.ccont (_v1024_cont) ((Bsl_init_.clos_env_1 (_v2_clos_anon_fun_body) (_v1024_cont)))) in
let _v812_val = Link_web_chat_002._v283_const in
let _v1028_cont = (QmlCpsServerLib.ccont (_v1025_cont) ((Bsl_init_.clos_env_2 (_v22_clos_anon_fun_body) (_v1025_cont) (_v812_val)))) in
let _v1029_cont = (QmlCpsServerLib.ccont (_v1028_cont) ((Bsl_init_.clos_env_1 (_v23_clos_anon_fun_body) (_v1028_cont)))) in
let _v1030_cont = (QmlCpsServerLib.ccont (_v1029_cont) ((Bsl_init_.clos_env_2 (_v25_clos_anon_fun_body) (_v15_extra_author) (_v1029_cont)))) in
let _v800_val = Link_web_chat_002._v266_const in
(Opa_stdlib_2ecore_2efunaction_001._v1_FunActionServer_serialize_argument_0ceeb04a (Link_web_chat_002._v2_memo_ty) (_v800_val) (_v6_extra_room_name) (_v1030_cont))
let _v26_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v4_anon_fun_body) (4) (Link_web_chat_002._v284_const) (Link_web_chat_001._v2_const))))
let _v31_anon_fun_body _v125_extra_cont _v51_extra_val _v52_extra_val _v53_extra_val _v742_val = let _v757_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["args" ; "content" ; "namespace" ; "specific_attributes" ; "tag"] *) Link_web_chat_001._v25_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v52_extra_val))) ; (((Obj.repr) (_v742_val))) ; (((Obj.repr) (Opa_stdlib_2ecore_2exhtml_026._v2_ns_uri_2b6d75d2))) ; (((Obj.repr) (_v51_extra_val))) ; (((Obj.repr) (_v53_extra_val))) |])) in
(QmlCpsServerLib.return (_v125_extra_cont) (_v757_val))
let _v27_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v31_anon_fun_body) (5) (Link_web_chat_002._v285_const) (Link_web_chat_001._v2_const))))
let _v32_anon_fun_body _v126_extra_cont _v54_extra_val _v745_val = let _v755_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v54_extra_val))) ; (((Obj.repr) (_v745_val))) |])) in
(QmlCpsServerLib.return (_v126_extra_cont) (_v755_val))
let _v28_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v32_anon_fun_body) (3) (Link_web_chat_002._v286_const) (Link_web_chat_001._v2_const))))
let _v33_anon_fun_body _v127_extra_cont _v746_val = let _v754_val = Link_web_chat_001._v174_const in
let _v753_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v746_val))) ; (((Obj.repr) (_v754_val))) |])) in
(QmlCpsServerLib.return (_v127_extra_cont) (_v753_val))
let _v29_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v33_anon_fun_body) (2) (Link_web_chat_002._v287_const) (Link_web_chat_001._v2_const))))
let _v34_anon_fun_body _v128_extra_cont _v263_arg = let _v747_val = ((Opa_stdlib_2ecore_2exhtml_026._v0_create_fragment_skip_2b6d75d2) (_v263_arg)) in
(QmlCpsServerLib.return (_v128_extra_cont) (_v747_val))
let _v30_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v34_anon_fun_body) (2) (Link_web_chat_002._v288_const) (Link_web_chat_001._v2_const))))
let _v30_anon_fun_body _v0_extra_messages _v129_extra_cont _v55_extra_val _v56_extra_val _v706_val = let _v978_cont = (QmlCpsServerLib.ccont (_v129_extra_cont) ((Bsl_init_.clos_env_4 (_v27_clos_anon_fun_body) (_v129_extra_cont) (_v706_val) (_v55_extra_val) (_v56_extra_val)))) in
let _v756_val = Link_web_chat_001._v173_const in
let _v981_cont = (QmlCpsServerLib.ccont (_v978_cont) ((Bsl_init_.clos_env_2 (_v28_clos_anon_fun_body) (_v978_cont) (_v756_val)))) in
let _v982_cont = (QmlCpsServerLib.ccont (_v981_cont) ((Bsl_init_.clos_env_1 (_v29_clos_anon_fun_body) (_v981_cont)))) in
let _v983_cont = (QmlCpsServerLib.ccont (_v982_cont) ((Bsl_init_.clos_env_1 (_v30_clos_anon_fun_body) (_v982_cont)))) in
(Opa_stdlib_2ecore_014._v7_map_ec6de8cf (_v0_clos_history_to_html) (_v0_extra_messages) (_v983_cont))
let _v31_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v30_anon_fun_body) (5) (Link_web_chat_002._v289_const) (Link_web_chat_001._v2_const))))
let _v35_anon_fun_body _v130_extra_cont _v707_val = let _v741_val = ((QmlFlatServerLib.may_be_simple) ([| (((Obj.repr) (( (* ["some"] *) Link_web_chat_001._v18_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v707_val))) |])) in
(QmlCpsServerLib.return (_v130_extra_cont) (_v741_val))
let _v32_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v35_anon_fun_body) (2) (Link_web_chat_002._v290_const) (Link_web_chat_001._v2_const))))
let _v36_anon_fun_body _v131_extra_cont _v57_extra_val _v58_extra_val _v712_val = let _v738_val = Link_web_chat_001._v13_const in
let _v737_val = Link_web_chat_001._v81_const in
let _v736_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["class" ; "events" ; "events_options" ; "href" ; "style"] *) Link_web_chat_001._v17_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v58_extra_val))) ; (((Obj.repr) (_v712_val))) ; (((Obj.repr) (_v738_val))) ; (((Obj.repr) (_v737_val))) ; (((Obj.repr) (_v57_extra_val))) |])) in
(QmlCpsServerLib.return (_v131_extra_cont) (_v736_val))
let _v33_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v36_anon_fun_body) (4) (Link_web_chat_002._v291_const) (Link_web_chat_001._v2_const))))
let _v37_anon_fun_body _v132_extra_cont _v713_val = let _v731_val = Link_web_chat_001._v13_const in
let _v730_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v713_val))) ; (((Obj.repr) (_v731_val))) |])) in
(QmlCpsServerLib.return (_v132_extra_cont) (_v730_val))
let _v34_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v37_anon_fun_body) (2) (Link_web_chat_002._v292_const) (Link_web_chat_001._v2_const))))
let _v38_anon_fun_body _v133_extra_cont _v59_extra_val _v716_val = let _v726_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["name" ; "value"] *) Link_web_chat_001._v28_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v59_extra_val))) ; (((Obj.repr) (_v716_val))) |])) in
(QmlCpsServerLib.return (_v133_extra_cont) (_v726_val))
let _v35_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v38_anon_fun_body) (3) (Link_web_chat_002._v293_const) (Link_web_chat_001._v2_const))))
let _v39_anon_fun_body _v134_extra_cont _v717_val = let _v725_val = ((QmlFlatServerLib.may_be_simple) ([| (((Obj.repr) (( (* ["value"] *) Link_web_chat_001._v29_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v717_val))) |])) in
(QmlCpsServerLib.return (_v134_extra_cont) (_v725_val))
let _v36_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v39_anon_fun_body) (2) (Link_web_chat_002._v294_const) (Link_web_chat_001._v2_const))))
let _v40_anon_fun_body _v135_extra_cont _v0_arg = let _v724_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v0_arg))) ; (((Obj.repr) (Link_web_chat_001._v13_const))) |])) in
let _v723_val = Link_web_chat_001._v13_const in
(Opa_stdlib_2ecore_2efunaction_001._v1_FunActionServer_serialize_call_0ceeb04a (Link_web_chat_002._v0___v6_fun_action_eta_body) (_v723_val) (_v724_val) (_v135_extra_cont))
let _v37_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v40_anon_fun_body) (2) (Link_web_chat_002._v295_const) (Link_web_chat_001._v2_const))))
let _v0_anon_fun_body _v95_extra_cont _v259_arg = let _v926_val = Link_web_chat_002._v296_const in
let _v925_val = Link_web_chat_002._v297_const in
(Opa_stdlib_2ecore_2eweb_2eresource_010._v1_styled_page_01d140d3 (_v925_val) (_v926_val) (_v259_arg) (_v95_extra_cont))
let _v38_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v0_anon_fun_body) (2) (Link_web_chat_002._v298_const) (Link_web_chat_001._v2_const))))
let _v1_anon_fun_body _v96_extra_cont _v642_val = let _v921_val = ((QmlFlatServerLib.may_be_simple) ([| (((Obj.repr) (( (* ["fragment"] *) Link_web_chat_001._v31_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v642_val))) |])) in
(QmlCpsServerLib.return (_v96_extra_cont) (_v921_val))
let _v39_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v1_anon_fun_body) (2) (Link_web_chat_002._v299_const) (Link_web_chat_001._v2_const))))
let _v2_anon_fun_body _v97_extra_cont _v32_extra_val _v692_val = let _v919_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v32_extra_val))) ; (((Obj.repr) (_v692_val))) |])) in
(QmlCpsServerLib.return (_v97_extra_cont) (_v919_val))
let _v40_clos_anon_fun_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v2_anon_fun_body) (3) (Link_web_chat_002._v300_const) (Link_web_chat_001._v2_const))))
let _v1_body _v1_author _v0_messages _v0_room_name _v885_cont = let _v886_cont = (QmlCpsServerLib.ccont (_v885_cont) ((Bsl_init_.clos_env_1 (_v38_clos_anon_fun_body) (_v885_cont)))) in
let _v888_cont = (QmlCpsServerLib.ccont (_v886_cont) ((Bsl_init_.clos_env_1 (_v39_clos_anon_fun_body) (_v886_cont)))) in
let _v920_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["args" ; "content" ; "namespace" ; "specific_attributes" ; "tag"] *) Link_web_chat_001._v25_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["name" ; "namespace" ; "value"] *) Link_web_chat_001._v30_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (Link_web_chat_002._v281_const))) ; (((Obj.repr) (Opa_stdlib_2ecore_2exhtml_026._v2_ns_uri_2b6d75d2))) ; (((Obj.repr) (Link_web_chat_002._v303_const))) |]))))) ; (((Obj.repr) (Link_web_chat_001._v13_const))) |]))))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["args" ; "content" ; "namespace" ; "specific_attributes" ; "tag"] *) Link_web_chat_001._v25_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["name" ; "namespace" ; "value"] *) Link_web_chat_001._v30_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (Link_web_chat_002._v281_const))) ; (((Obj.repr) (Opa_stdlib_2ecore_2exhtml_026._v2_ns_uri_2b6d75d2))) ; (((Obj.repr) (Link_web_chat_002._v302_const))) |]))))) ; (((Obj.repr) (Link_web_chat_001._v13_const))) |]))))) ; (((Obj.repr) (Link_web_chat_001._v13_const))) ; (((Obj.repr) (Opa_stdlib_2ecore_2exhtml_026._v2_ns_uri_2b6d75d2))) ; (((Obj.repr) (Link_web_chat_001._v81_const))) ; (((Obj.repr) (Link_web_chat_001._v179_const))) |]))))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["args" ; "content" ; "namespace" ; "specific_attributes" ; "tag"] *) Link_web_chat_001._v25_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["name" ; "namespace" ; "value"] *) Link_web_chat_001._v30_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (Link_web_chat_002._v281_const))) ; (((Obj.repr) (Opa_stdlib_2ecore_2exhtml_026._v2_ns_uri_2b6d75d2))) ; (((Obj.repr) (Link_web_chat_001._v170_const))) |]))))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["name" ; "namespace" ; "value"] *) Link_web_chat_001._v30_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (Link_web_chat_002._v301_const))) ; (((Obj.repr) (Opa_stdlib_2ecore_2exhtml_026._v2_ns_uri_2b6d75d2))) ; (((Obj.repr) (((Opa_stdlib_2ecore_013._v0_identity_skip_ec6de8cf) (_v1_author))))) |]))))) ; (((Obj.repr) (Link_web_chat_001._v13_const))) |]))))) |]))))) ; (((Obj.repr) (Link_web_chat_001._v13_const))) ; (((Obj.repr) (Opa_stdlib_2ecore_2exhtml_026._v2_ns_uri_2b6d75d2))) ; (((Obj.repr) (Link_web_chat_001._v81_const))) ; (((Obj.repr) (Link_web_chat_002._v282_const))) |]))))) ; (((Obj.repr) (Link_web_chat_001._v13_const))) |]))))) |]))))) ; (((Obj.repr) (Opa_stdlib_2ecore_2exhtml_026._v2_ns_uri_2b6d75d2))) ; (((Obj.repr) (Link_web_chat_001._v81_const))) ; (((Obj.repr) (Link_web_chat_001._v179_const))) |])) in
let _v938_cont = (QmlCpsServerLib.ccont (_v888_cont) ((Bsl_init_.clos_env_2 (_v40_clos_anon_fun_body) (_v888_cont) (_v920_val)))) in
let _v918_val = Link_web_chat_002._v279_const in
let _v941_cont = (QmlCpsServerLib.ccont (_v938_cont) ((Bsl_init_.clos_env_2 (_v0_clos_anon_fun_body) (_v938_cont) (_v918_val)))) in
let _v942_cont = (QmlCpsServerLib.ccont (_v941_cont) ((Bsl_init_.clos_env_3 (_v26_clos_anon_fun_body) (_v0_room_name) (_v1_author) (_v941_cont)))) in
let _v759_val = Link_web_chat_001._v179_const in
let _v758_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["name" ; "namespace" ; "value"] *) Link_web_chat_001._v30_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (Link_web_chat_002._v281_const))) ; (((Obj.repr) (Opa_stdlib_2ecore_2exhtml_026._v2_ns_uri_2b6d75d2))) ; (((Obj.repr) (Link_web_chat_002._v210_const))) |]))))) ; (((Obj.repr) (Link_web_chat_001._v13_const))) |])) in
let _v952_cont = (QmlCpsServerLib.ccont (_v942_cont) ((Bsl_init_.clos_env_4 (_v31_clos_anon_fun_body) (_v0_messages) (_v942_cont) (_v758_val) (_v759_val)))) in
let _v953_cont = (QmlCpsServerLib.ccont (_v952_cont) ((Bsl_init_.clos_env_1 (_v32_clos_anon_fun_body) (_v952_cont)))) in
let _v740_val = Link_web_chat_001._v13_const in
let _v739_val = Link_web_chat_001._v13_const in
let _v958_cont = (QmlCpsServerLib.ccont (_v953_cont) ((Bsl_init_.clos_env_3 (_v33_clos_anon_fun_body) (_v953_cont) (_v739_val) (_v740_val)))) in
let _v959_cont = (QmlCpsServerLib.ccont (_v958_cont) ((Bsl_init_.clos_env_1 (_v34_clos_anon_fun_body) (_v958_cont)))) in
let _v727_val = Link_web_chat_002._v304_const in
let _v962_cont = (QmlCpsServerLib.ccont (_v959_cont) ((Bsl_init_.clos_env_2 (_v35_clos_anon_fun_body) (_v959_cont) (_v727_val)))) in
let _v963_cont = (QmlCpsServerLib.ccont (_v962_cont) ((Bsl_init_.clos_env_1 (_v36_clos_anon_fun_body) (_v962_cont)))) in
let _v964_cont = (QmlCpsServerLib.ccont (_v963_cont) ((Bsl_init_.clos_env_1 (_v37_clos_anon_fun_body) (_v963_cont)))) in
let _v718_val = Link_web_chat_002._v266_const in
(Opa_stdlib_2ecore_2efunaction_001._v1_FunActionServer_serialize_argument_0ceeb04a (Link_web_chat_002._v2_memo_ty) (_v718_val) (_v1_author) (_v964_cont))
let _v5_anon_fun_setup_room _v140_extra_cont _v63_extra_val _v280_arg = let _v931_val = (OpabslgenMLRuntime.Badoplink.dbpath_add (_v280_arg) (_v63_extra_val)) in
(QmlCpsServerLib.return (_v140_extra_cont) (_v931_val))
let _v0_clos_anon_fun_setup_room = ((Obj.magic) ((Bsl_init_.bslp26 (_v5_anon_fun_setup_room) (3) (Link_web_chat_002._v305_const) (Link_web_chat_001._v2_const))))
let _v6_anon_fun_setup_room _v142_extra_cont _v927_val = (match ((QmlFlatServerLib.unwrap_record) (_v927_val)) with
[| _v18_vt ; _ ; lazy _v17_some |] when (((==)) (((Obj.magic) (_v18_vt))) (( (* ["some"] *) Link_web_chat_001._v18_shared_vtable))) -> let _v13_x = ((Obj.magic) (_v17_some)) in
(QmlCpsServerLib.return (_v142_extra_cont) (_v13_x))
| _v11_none when (((==)) (((Obj.magic) (_v11_none))) (Link_web_chat_001._v0_simple_none)) -> (OpabslgenMLRuntime.Badoplink.trans_start (Link_web_chat_002._v1__inaccessible_db_ident) (_v142_extra_cont)))
let _v1_clos_anon_fun_setup_room = ((Obj.magic) ((Bsl_init_.bslp26 (_v6_anon_fun_setup_room) (2) (Link_web_chat_002._v306_const) (Link_web_chat_001._v2_const))))
let _v0_anon_fun_setup_room _v0_extra_name _v136_extra_cont _v60_extra_val _v1_messages = (_v1_body (_v60_extra_val) (_v1_messages) (_v0_extra_name) (_v136_extra_cont))
let _v2_clos_anon_fun_setup_room = ((Obj.magic) ((Bsl_init_.bslp26 (_v0_anon_fun_setup_room) (4) (Link_web_chat_002._v307_const) (Link_web_chat_001._v2_const))))
let _v2_anon_fun_setup_room _v12_extra_tr _v137_extra_cont _v274_arg = (Link_web_chat_002._v1_get_n3 (_v12_extra_tr) (_v274_arg) (_v137_extra_cont))
let _v3_clos_anon_fun_setup_room = ((Obj.magic) ((Bsl_init_.bslp26 (_v2_anon_fun_setup_room) (3) (Link_web_chat_002._v308_const) (Link_web_chat_001._v2_const))))
let _v3_anon_fun_setup_room _v138_extra_cont _v61_extra_val _v275_arg = let _v935_val = (OpabslgenMLRuntime.Badoplink.dbpath_add (_v275_arg) (_v61_extra_val)) in
(QmlCpsServerLib.return (_v138_extra_cont) (_v935_val))
let _v4_clos_anon_fun_setup_room = ((Obj.magic) ((Bsl_init_.bslp26 (_v3_anon_fun_setup_room) (3) (Link_web_chat_002._v309_const) (Link_web_chat_001._v2_const))))
let _v4_anon_fun_setup_room _v139_extra_cont _v62_extra_val _v278_arg = let _v933_val = (OpabslgenMLRuntime.Badoplink.dbpath_add (_v278_arg) (_v62_extra_val)) in
(QmlCpsServerLib.return (_v139_extra_cont) (_v933_val))
let _v5_clos_anon_fun_setup_room = ((Obj.magic) ((Bsl_init_.bslp26 (_v4_anon_fun_setup_room) (3) (Link_web_chat_002._v310_const) (Link_web_chat_001._v2_const))))
let _v1_anon_fun_setup_room _v1_extra_name _v141_extra_cont _v34_tr = let _v1116_cont = (QmlCpsServerLib.ccont (_v141_extra_cont) ((Bsl_init_.clos_env_2 (_v3_clos_anon_fun_setup_room) (_v34_tr) (_v141_extra_cont)))) in
let _v936_val = let _v277_arg = 0 in
((OpabslgenMLRuntime.Badoplink.key_int) (_v277_arg)) in
let _v1119_cont = (QmlCpsServerLib.ccont (_v1116_cont) ((Bsl_init_.clos_env_2 (_v4_clos_anon_fun_setup_room) (_v1116_cont) (_v936_val)))) in
let _v934_val = ((OpabslgenMLRuntime.Badoplink.key_string) (_v1_extra_name)) in
let _v1121_cont = (QmlCpsServerLib.ccont (_v1119_cont) ((Bsl_init_.clos_env_2 (_v5_clos_anon_fun_setup_room) (_v1119_cont) (_v934_val)))) in
let _v932_val = let _v282_arg = ( (* Eliminated vtable for field edge_root_0 *) (QmlFlatServerLib.unsafe_get (13) (Link_web_chat_002._v1_edge_map_))) in
((OpabslgenMLRuntime.Badoplink.key_int) (_v282_arg)) in
let _v1125_cont = (QmlCpsServerLib.ccont (_v1121_cont) ((Bsl_init_.clos_env_2 (_v0_clos_anon_fun_setup_room) (_v1121_cont) (_v932_val)))) in
let _v930_val = let _v285_arg = 1 in
((OpabslgenMLRuntime.Badoplink.key_int) (_v285_arg)) in
let _v928_val = OpabslgenMLRuntime.Badoplink.dbpath_root in
let _v929_val = (OpabslgenMLRuntime.Badoplink.dbpath_add (_v928_val) (_v930_val)) in
(QmlCpsServerLib.return (_v1125_cont) (_v929_val))
let _v6_clos_anon_fun_setup_room = ((Obj.magic) ((Bsl_init_.bslp26 (_v1_anon_fun_setup_room) (3) (Link_web_chat_002._v311_const) (Link_web_chat_001._v2_const))))
let _v1_setup_room _v0_name _v1110_cont = let _v937_val = let _v273_arg = 8 in
((Opa_stdlib_2ecore_023._v0_string_skip_ec6de8cf) (_v273_arg)) in
let _v1113_cont = (QmlCpsServerLib.ccont (_v1110_cont) ((Bsl_init_.clos_env_3 (_v2_clos_anon_fun_setup_room) (_v0_name) (_v1110_cont) (_v937_val)))) in
let _v1114_cont = (QmlCpsServerLib.ccont (_v1113_cont) ((Bsl_init_.clos_env_2 (_v6_clos_anon_fun_setup_room) (_v0_name) (_v1113_cont)))) in
let _v1115_cont = (QmlCpsServerLib.ccont (_v1114_cont) ((Bsl_init_.clos_env_1 (_v1_clos_anon_fun_setup_room) (_v1114_cont)))) in
(OpabslgenMLRuntime.Opa_transaction.get_global_transaction_opt (Link_web_chat_002._v1__inaccessible_db_ident) (_v1115_cont))
let _v0_anon_fun_start _v143_extra_cont _v287_arg = (_v1_setup_room (_v287_arg) (_v143_extra_cont))
let _v0_clos_anon_fun_start = ((Obj.magic) ((Bsl_init_.bslp26 (_v0_anon_fun_start) (2) (Link_web_chat_002._v312_const) (Link_web_chat_001._v2_const))))
let _v1_anon_fun_start _v144_extra_cont _v288_arg = let _v939_val = ((Opa_stdlib_2ecore_015._v0_to_lower_skip_ec6de8cf) (_v288_arg)) in
(QmlCpsServerLib.return (_v144_extra_cont) (_v939_val))
let _v1_clos_anon_fun_start = ((Obj.magic) ((Bsl_init_.bslp26 (_v1_anon_fun_start) (2) (Link_web_chat_002._v313_const) (Link_web_chat_001._v2_const))))
let _v1_start _v0___4__ _v1129_cont = (match (QmlFlatServerLib.dot_opt (Link_web_chat_001._v0_label_path) (_v0___4__)) with
Some ( _v23_nil ) when (((==)) (((Obj.magic) (_v23_nil))) (Link_web_chat_001._v0_simple_nil)) -> let _v938_val = Link_web_chat_002._v314_const in
(_v1_setup_room (_v938_val) (_v1129_cont))
| _ -> (match (QmlFlatServerLib.dot_opt (Link_web_chat_001._v0_label_path) (_v0___4__)) with
Some ( _v0_path ) -> let _v1131_cont = (QmlCpsServerLib.ccont (_v1129_cont) ((Bsl_init_.clos_env_1 (_v0_clos_anon_fun_start) (_v1129_cont)))) in
let _v1132_cont = (QmlCpsServerLib.ccont (_v1131_cont) ((Bsl_init_.clos_env_1 (_v1_clos_anon_fun_start) (_v1131_cont)))) in
(Opa_stdlib_2ecore_014._v3_head_ec6de8cf (_v0_path) (_v1132_cont))
| _ -> ((QmlFlatServerLib.runtime_error) ("todo match failure with position"))))
let _v0_clos_start = ((Obj.magic) ((Bsl_init_.bslp26 (_v1_start) (2) (Link_web_chat_002._v315_const) (Link_web_chat_001._v2_const))))
let _v1_anon_fun__do_ _v0_extra__do__barrier _v947_val = (QmlCpsServerLib.black_release_barrier (_v0_extra__do__barrier) (_v947_val))
let _v0_clos_anon_fun__do_ = ((Obj.magic) ((Bsl_init_.bslp26 (_v1_anon_fun__do_) (2) (Link_web_chat_002._v316_const) (Link_web_chat_001._v2_const))))
let _v0_anon_fun__do_ _v1_extra__do__barrier _v289_arg = let _v1141_cont = ((QmlCpsServerLib.cont) ((Bsl_init_.clos_env_1 (_v0_clos_anon_fun__do_) (_v1_extra__do__barrier)))) in
(Bsl_init_.clos_args_2 (Opa_stdlib_2ecore_2eweb_2eserver_010._v1_Server_private_add_service_b970f080) (_v289_arg) (_v1141_cont))
let _v1_clos_anon_fun__do_ = ((Obj.magic) ((Bsl_init_.bslp26 (_v0_anon_fun__do_) (2) (Link_web_chat_002._v317_const) (Link_web_chat_001._v2_const))))
let _v2_anon_fun__do_ _v145_extra_cont _v290_arg = (Opa_stdlib_2ecore_2eweb_2eserver_010._v1_of_bundle_b970f080 (_v290_arg) (_v145_extra_cont))
let _v2_clos_anon_fun__do_ = ((Obj.magic) ((Bsl_init_.bslp26 (_v2_anon_fun__do_) (2) (Link_web_chat_002._v318_const) (Link_web_chat_001._v2_const))))
let _v3_anon_fun__do_ _v146_extra_cont _v941_val = let _v946_val = Link_web_chat_001._v13_const in
let _v945_val = ((QmlFlatServerLib.unsafe_init_static) ([| (((Obj.repr) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v941_val))) ; (((Obj.repr) (_v946_val))) |])) in
(QmlCpsServerLib.return (_v146_extra_cont) (_v945_val))
let _v3_clos_anon_fun__do_ = ((Obj.magic) ((Bsl_init_.bslp26 (_v3_anon_fun__do_) (2) (Link_web_chat_002._v319_const) (Link_web_chat_001._v2_const))))
let _v4_anon_fun__do_ _v147_extra_cont _v0_map_1 = (QmlCpsServerLib.return (_v147_extra_cont) (_v0_map_1))
let _v4_clos_anon_fun__do_ = ((Obj.magic) ((Bsl_init_.bslp26 (_v4_anon_fun__do_) (2) (Link_web_chat_002._v320_const) (Link_web_chat_001._v2_const))))
let _v4__do_ = ((Obj.magic) (let _v5_before = ((QmlCpsServerLib.before_wait) (Link_web_chat_001._v1_const)) in
let _v0__do__barrier = ((QmlCpsServerLib.black_make_barrier) (Link_web_chat_002._v321_const)) in
let _v5_barrier_unit = let _v1134_cont = ((QmlCpsServerLib.cont) ((Bsl_init_.clos_env_1 (_v1_clos_anon_fun__do_) (_v0__do__barrier)))) in
let _v1135_cont = (QmlCpsServerLib.ccont (_v1134_cont) ((Bsl_init_.clos_env_1 (_v2_clos_anon_fun__do_) (_v1134_cont)))) in
let _v1136_cont = (QmlCpsServerLib.ccont (_v1135_cont) ((Bsl_init_.clos_env_1 (_v3_clos_anon_fun__do_) (_v1135_cont)))) in
let _v1137_cont = (QmlCpsServerLib.ccont (_v1136_cont) ((Bsl_init_.clos_env_1 (_v4_clos_anon_fun__do_) (_v1136_cont)))) in
let _v942_val = Link_web_chat_001._v63_const in
(Bsl_init_.clos_args_4 (Opa_stdlib_2ecore_2emap_007._v1_StringMap_add_ec0784c7) (_v942_val) (Link_web_chat_002._v1_static_include_resource) (Opa_stdlib_2ecore_2emap_007._v1_StringMap_empty_ec0784c7) (_v1137_cont)) in
((OpabslgenMLRuntime.BslCps.black_toplevel_wait) (_v0__do__barrier))))
let _v5_anon_fun__do_ _v2_extra__do__barrier _v948_val = (QmlCpsServerLib.black_release_barrier (_v2_extra__do__barrier) (_v948_val))
let _v5_clos_anon_fun__do_ = ((Obj.magic) ((Bsl_init_.bslp26 (_v5_anon_fun__do_) (2) (Link_web_chat_002._v322_const) (Link_web_chat_001._v2_const))))
let _v5__do_ = ((Obj.magic) (let _v6_before = ((QmlCpsServerLib.before_wait) (Link_web_chat_001._v1_const)) in
let _v1__do__barrier = ((QmlCpsServerLib.black_make_barrier) (Link_web_chat_002._v323_const)) in
let _v6_barrier_unit = let _v949_val = ((Opa_stdlib_2ecore_2eweb_2eserver_010._v0_simple_dispatch_skip_b970f080) (_v0_clos_start)) in
let _v1143_cont = ((QmlCpsServerLib.cont) ((Bsl_init_.clos_env_1 (_v5_clos_anon_fun__do_) (_v1__do__barrier)))) in
(Bsl_init_.clos_args_2 (Opa_stdlib_2ecore_2eweb_2eserver_010._v1_Server_private_add_service_b970f080) (_v949_val) (_v1143_cont)) in
((OpabslgenMLRuntime.BslCps.black_toplevel_wait) (_v1__do__barrier))))
let _v3_anon_fun_skeleton_fun_action_body _v148_extra_cont _v950_val = let _v952_val = ((QmlFlatServerLib.may_be_simple) ([| (((Obj.repr) (( (* ["some"] *) Link_web_chat_001._v18_shared_vtable)))) ; (((Obj.repr) (None))) ; (((Obj.repr) (_v950_val))) |])) in
(QmlCpsServerLib.return (_v148_extra_cont) (_v952_val))
let _v0_clos_anon_fun_skeleton_fun_action_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v3_anon_fun_skeleton_fun_action_body) (2) (Link_web_chat_002._v324_const) (Link_web_chat_001._v2_const))))
let _v2_anon_fun_skeleton_fun_action_body _v3_extra_tres _v149_extra_cont _v955_val = (match ((QmlFlatServerLib.unwrap_record) (_v955_val)) with
[| _v19_vt ; _ ; lazy _v18_some |] when (((&&)) ((((==)) (((Obj.magic) (_v19_vt))) (( (* ["some"] *) Link_web_chat_001._v18_shared_vtable)))) ((((&&)) ((((==)) (((QmlFlatServerLib.get_vtable) (((Obj.magic) (_v18_some))))) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) (let _v22_tl = (QmlFlatServerLib.unsafe_get (1) (((Obj.magic) (_v18_some)))) in
(((&&)) ((((==)) (((QmlFlatServerLib.get_vtable) (((Obj.magic) (_v22_tl))))) (( (* ["hd" ; "tl"] *) Link_web_chat_001._v3_shared_vtable)))) (let _v23_tl = (QmlFlatServerLib.unsafe_get (1) (((Obj.magic) (_v22_tl)))) in
(((==)) (((Obj.magic) (_v23_tl))) (Link_web_chat_001._v0_simple_nil)))))))) -> let _v4_a1 = (QmlFlatServerLib.unsafe_get (0) (((Obj.magic) (_v18_some)))) in
let _v24_tl = (QmlFlatServerLib.unsafe_get (1) (((Obj.magic) (_v18_some)))) in
let _v1_a2 = (QmlFlatServerLib.unsafe_get (0) (((Obj.magic) (_v24_tl)))) in
let _v1146_cont = (QmlCpsServerLib.ccont (_v149_extra_cont) ((Bsl_init_.clos_env_1 (_v0_clos_anon_fun_skeleton_fun_action_body) (_v149_extra_cont)))) in
let _v951_val = (_v1_fun_action_body_skip (_v4_a1) (_v1_a2)) in
(Opa_stdlib_2ecore_2erpc_2ecore_019._v1_OpaSerialize_serialize_f2f00d5f (_v3_extra_tres) (_v951_val) (_v1146_cont))
| _ -> let _v954_val = Link_web_chat_001._v81_const in
(QmlCpsServerLib.return (_v149_extra_cont) (_v954_val)))
let _v1_clos_anon_fun_skeleton_fun_action_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v2_anon_fun_skeleton_fun_action_body) (3) (Link_web_chat_002._v325_const) (Link_web_chat_001._v2_const))))
let _v1_anon_fun_skeleton_fun_action_body _v0_extra_request _v150_extra_cont _v958_val = (match ((QmlFlatServerLib.unwrap_record) (_v958_val)) with
[| _v20_vt ; _ ; lazy _v8_TyArrow_params ; lazy _v3_TyArrow_res |] when (((==)) (((Obj.magic) (_v20_vt))) (( (* ["TyArrow_params" ; "TyArrow_res"] *) Link_web_chat_001._v8_shared_vtable))) -> let _v1_ts = ((Obj.magic) (_v8_TyArrow_params)) in
let _v7_tres = ((Obj.magic) (_v3_TyArrow_res)) in
let _v1149_cont = (QmlCpsServerLib.ccont (_v150_extra_cont) ((Bsl_init_.clos_env_2 (_v1_clos_anon_fun_skeleton_fun_action_body) (_v7_tres) (_v150_extra_cont)))) in
(Opa_stdlib_2ecore_2erpc_2ecore_019._v1_OpaRPC_extract_values_f2f00d5f (_v0_extra_request) (_v1_ts) (_v1149_cont))
| _ -> let _v957_val = Link_web_chat_001._v81_const in
(QmlCpsServerLib.return (_v150_extra_cont) (_v957_val)))
let _v2_clos_anon_fun_skeleton_fun_action_body = ((Obj.magic) ((Bsl_init_.bslp26 (_v1_anon_fun_skeleton_fun_action_body) (3) (Link_web_chat_002._v326_const) (Link_web_chat_001._v2_const))))
let _v0_anon_fun_skeleton_fun_action_body _v151_extra_cont _v965_val = (match ((QmlFlatServerLib.unwrap_record) (_v965_val)) with
[| _v22_vt ; _ ; lazy _v19_some |] when (((==)) (((Obj.magic) (_v22_vt))) (( (* ["some"] *) Link_web_chat_001._v18_shared_vtable))) -> let _v2_request = ((Obj.magic) (_v19_some)) in
let _v962_val = ((Opa_stdlib_2ecore_2erpc_2ecore_017._v0_extract_types_skip_f2f00d5f) (_v2_request)) in
(match ((QmlFlatServerLib.unwrap_record) (_v962_val)) with
[| _v21_vt ; _ ; lazy _v3_cols ; lazy _v3_rows ; lazy _v3_types |] when (((&&)) ((((&&)) ((((&&)) ((((==)) (((Obj.magic) (_v21_vt))) (( (* ["cols" ; "rows" ; "types"] *) Link_web_chat_001._v7_shared_vtable)))) ((((==)) (((Obj.magic) (_v3_cols))) (Link_web_chat_001._v0_simple_nil))))) ((((==)) (((Obj.magic) (_v3_rows))) (Link_web_chat_001._v0_simple_nil))))) ((((==)) (((Obj.magic) (_v3_types))) (Link_web_chat_001._v0_simple_nil)))) -> let _v1151_cont = (QmlCpsServerLib.ccont (_v151_extra_cont) ((Bsl_init_.clos_env_2 (_v2_clos_anon_fun_skeleton_fun_action_body) (_v2_request) (_v151_extra_cont)))) in
(Opa_stdlib_2ecore_2erpc_2ecore_012._v1_OpaTsc_implementation_f2f00d5f (_v962_val) (Link_web_chat_002._v22_memo_ty) (_v1151_cont))
| _ -> let _v960_val = Link_web_chat_001._v81_const in
(QmlCpsServerLib.return (_v151_extra_cont) (_v960_val)))
| _v12_none when (((==)) (((Obj.magic) (_v12_none))) (Link_web_chat_001._v0_simple_none)) -> let _v964_val = Link_web_chat_001._v81_const in
(QmlCpsServerLib.return (_v151_extra_cont) (_v964_val)))
